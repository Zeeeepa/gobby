{"id": "mm-e97a285c", "content": "The gobby project uses SQLite with custom datetime adapters. The `_adapt_datetime` function in `database.py` (line 24) uses `isoformat(\" \")` which produces space-separated timestamps like \"2026-01-25 01:43:54\" instead of ISO 8601 standard \"2026-01-25T01:43:54\". This non-standard format can cause timestamp normalization issues in exported JSONL files.", "type": "fact", "importance": 0.9, "tags": ["database", "datetime", "sqlite", "bug-source"], "created_at": "2026-01-25T03:58:56.473712+00:00", "updated_at": "2026-01-25T03:58:56.473712+00:00", "source": "session", "source_id": "8dfb36ae-572d-4a12-a667-0e710b658a2d"}
{"id": "mm-269f997a", "content": "Gobby uses ISO 8601 timestamps with 'T' separator (not space) in database and JSON files. The root cause of timestamp issues was using `isoformat(\" \")` instead of `isoformat()` in src/gobby/storage/database.py. When fixing timestamps, normalize existing data from space to T separator format.", "type": "fact", "importance": 0.9, "tags": ["timestamps", "database", "iso8601", "data-migration"], "created_at": "2026-01-25T04:02:56.261015+00:00", "updated_at": "2026-01-25T04:02:56.261015+00:00", "source": "session", "source_id": "1a867b59-ad3d-4075-9020-6293616fbeb2"}
{"id": "mm-5e7a4810", "content": "The gobby project uses a task management system with MCP tool `mcp__gobby__call_tool` for closing tasks. The close_task operation requires a 'reason' parameter (not 'resolution'), and task closure is only possible after commits are made with the commit SHA.", "type": "fact", "importance": 0.9, "tags": ["gobby", "task-management", "mcp-tools", "workflow"], "created_at": "2026-01-25T04:08:42.982283+00:00", "updated_at": "2026-01-25T04:08:42.982283+00:00", "source": "session", "source_id": "82c1590d-8051-4ccf-af2c-988867c7e884"}
{"id": "mm-10c7ed85", "content": "The gobby project uses a SafeExpressionEvaluator (AST-based) instead of eval() for security-critical expression evaluation in task enforcement actions. This pattern should be applied whenever dynamic expressions need evaluation.", "type": "pattern", "importance": 0.9, "tags": ["security", "task-enforcement", "expression-evaluation"], "created_at": "2026-01-25T04:34:46.436166+00:00", "updated_at": "2026-01-25T04:34:46.436166+00:00", "source": "session", "source_id": "0c5227bc-84b1-44b2-9e75-32fd96ec85ca"}
{"id": "mm-06c2e32f", "content": "gobby-tasks.list_tasks() returns results in result.get('results', []) not result.get('tasks', []). When filtering for __diag__ artifacts in cleanup, iterate over result.get('results', []) and check task.get('title', '').startswith('__diag__'), then call close_task(task_id=task['id'], reason='obsolete') or delete_task(task_id=task['id']) for each match.", "type": "fact", "importance": 0.85, "tags": ["gobby-tasks", "api-patterns", "cleanup", "MCP-tools"], "created_at": "2026-01-25T04:38:01.651928+00:00", "updated_at": "2026-01-25T04:38:01.651928+00:00", "source": "session", "source_id": "389037ea-8953-4e4f-bcb4-29c5dc468357"}
{"id": "mm-5d78c5cf", "content": "The gobby project has 14 test failures across 4 categories: session message tests (3), git logging tests (10), skill version warnings (2), and E2E daemon timeout (1). Session tests need assertions updated from 'Session enhanced by gobby' to check for 'Gobby Session ID:' and 'External ID:'. Git logging tests require a caplog autouse fixture to capture the gobby.utils.git logger.", "type": "context", "importance": 0.85, "tags": ["test-failures", "gobby", "debugging"], "created_at": "2026-01-25T03:55:11.338525+00:00", "updated_at": "2026-01-25T03:55:11.338525+00:00", "source": "session", "source_id": "f41bfbd1-8db4-4411-af15-7986f3249da4"}
{"id": "mm-44e91fb4", "content": "The gobby project has a `TaskSyncManager` that handles export from SQLite to JSONL format, triggered via CLI command `gobby tasks sync --export`. Timestamps are written as-is from the database without normalization during export, so fixing timestamps at the database level (via SQL normalization) is more effective than post-processing the JSONL file.", "type": "fact", "importance": 0.85, "tags": ["architecture", "cli", "export", "workflow"], "created_at": "2026-01-25T03:58:56.475053+00:00", "updated_at": "2026-01-25T03:58:56.475053+00:00", "source": "session", "source_id": "8dfb36ae-572d-4a12-a667-0e710b658a2d"}
{"id": "mm-d86722c7", "content": "The _LazyBool class in task_enforcement_actions.py lacks __eq__ and __ne__ operators, causing expressions like 'session_has_dirty_files == False' to skip thunk evaluation. Add __eq__(self, other) and __ne__(self, other) methods that coerce self to bool via bool(self) before comparison to ensure lazy evaluation is triggered and comparisons return correct True/False semantics.", "type": "pattern", "importance": 0.8, "tags": ["lazy-evaluation", "task-enforcement", "operator-overloading", "python-semantics"], "created_at": "2026-01-25T04:38:01.654226+00:00", "updated_at": "2026-01-25T04:38:01.654226+00:00", "source": "session", "source_id": "389037ea-8953-4e4f-bcb4-29c5dc468357"}
{"id": "mm-0dc68d2a", "content": "The _normalize_timestamp() function in sync/tasks.py should treat empty string as None (return None if ts == ''), and use regex pattern matching (e.g., r'Z|[+-]\\d{2}:\\d{2}$') to detect RFC3339 timezone suffixes instead of brittle slice checks. Only append 'Z' when the pattern does not match the timestamp suffix.", "type": "pattern", "importance": 0.8, "tags": ["timestamp-handling", "iso8601", "sync", "task-export", "regex-validation"], "created_at": "2026-01-25T04:38:01.653774+00:00", "updated_at": "2026-01-25T04:38:01.653774+00:00", "source": "session", "source_id": "389037ea-8953-4e4f-bcb4-29c5dc468357"}
{"id": "mm-f66580f6", "content": "Memory records in .gobby/memories.jsonl must have non-empty 'content' field. Add validation in create_memory() and import_from_jsonl() to reject or skip records where content is null, empty string, or missing. This prevents silent data loss and ensures all stored memories are meaningful.", "type": "pattern", "importance": 0.8, "tags": ["validation", "memories", "data-integrity", "error-handling"], "created_at": "2026-01-25T04:38:01.652762+00:00", "updated_at": "2026-01-25T04:38:01.652762+00:00", "source": "session", "source_id": "389037ea-8953-4e4f-bcb4-29c5dc468357"}
{"id": "mm-9fde2a09", "content": "Gobby daemon runs on two ports: 60887 (primary) and 60888 (secondary). These are the standard ports for the Gobby service.", "type": "fact", "importance": 0.8, "tags": ["gobby", "daemon", "ports", "configuration"], "created_at": "2026-01-25T04:37:25.374791+00:00", "updated_at": "2026-01-25T04:37:25.374791+00:00", "source": "session", "source_id": "9802ab5d-afe8-4c12-a35e-228cedb63faa"}
{"id": "mm-53413dff", "content": "Async test methods in gobby test suite (especially in test_task_enforcement.py) require @pytest.mark.asyncio decorator above each async def so pytest-asyncio discovers and runs them correctly. Can also use pytestmark at class level as alternative.", "type": "pattern", "importance": 0.8, "tags": ["testing", "pytest-asyncio", "async"], "created_at": "2026-01-25T04:37:25.373896+00:00", "updated_at": "2026-01-25T04:37:25.373896+00:00", "source": "session", "source_id": "90eefa0c-bedd-4489-bcd4-df7bf8a3cc6b"}
{"id": "mm-28d8d578", "content": "Test fixtures in gobby: protect_production_resources fixture patches load_config in already-imported modules (e.g., gobby.runner, gobby.mcp_proxy.stdio) to use safe_load_config with test DB paths. Must be added to test signature to ensure safe DB is used when instantiating GobbyRunner.", "type": "fact", "importance": 0.8, "tags": ["testing", "fixtures", "safety"], "created_at": "2026-01-25T04:04:50.334561+00:00", "updated_at": "2026-01-25T04:04:50.334561+00:00", "source": "session", "source_id": "90eefa0c-bedd-4489-bcd4-df7bf8a3cc6b"}
{"id": "mm-56ae40e4", "content": "Gobby diagnostic skill uses `__diag__` prefix for self-cleaning test artifacts. Cleanup protocol (Step 3-4) must iterate over list_tasks() results and call close_task(task_id, reason='obsolete') or delete_task(task_id) for hard deletion. Similar patterns apply to memories, worktrees, and clonesâ€”always search by prefix/tag, iterate results, then clean up individually.", "type": "pattern", "importance": 0.8, "tags": ["gobby-diagnostic", "cleanup", "testing", "MCP-tools"], "created_at": "2026-01-25T04:04:50.335354+00:00", "updated_at": "2026-01-25T04:04:50.335354+00:00", "source": "session", "source_id": "90eefa0c-bedd-4489-bcd4-df7bf8a3cc6b"}
{"id": "mm-d8480438", "content": "Gobby task workflow: make targeted fixes, verify with tests (all must pass), run git operations selectively (stage only relevant files, not unrelated changes), commit with task number format [#XXXX], then use tool to close task. The .gobby/tasks.jsonl file tracks task metadata.", "type": "pattern", "importance": 0.8, "tags": ["workflow", "git-practices", "testing", "task-management"], "created_at": "2026-01-25T04:04:50.336149+00:00", "updated_at": "2026-01-25T04:04:50.336149+00:00", "source": "session", "source_id": "1a867b59-ad3d-4075-9020-6293616fbeb2"}
{"id": "mm-990d4ac7", "content": "The _is_plan_file() function in task_enforcement_actions.py should explicitly check `if source != \"claude\"` rather than `if source and source != \"claude\"` to enforce that a source value must be present and not 'claude'. This prevents plan files from being processed without explicit source attribution.", "type": "pattern", "importance": 0.8, "tags": ["validation", "task-enforcement", "source-attribution"], "created_at": "2026-01-25T04:04:50.336988+00:00", "updated_at": "2026-01-25T04:04:50.336988+00:00", "source": "session", "source_id": "1a867b59-ad3d-4075-9020-6293616fbeb2"}
{"id": "mm-7f5d5a3e", "content": "In claiming-tasks/SKILL.md API documentation, the task_id extraction requires accessing a nested 'suggestion' object in the response, not at the top level. The API path pattern is important for skill implementations that interact with task management.", "type": "fact", "importance": 0.8, "tags": ["api-patterns", "skills", "claiming-tasks"], "created_at": "2026-01-25T04:04:50.338321+00:00", "updated_at": "2026-01-25T04:04:50.338321+00:00", "source": "session", "source_id": "1a867b59-ad3d-4075-9020-6293616fbeb2"}
{"id": "mm-f905f7ab", "content": "Skill SKILL.md files must use semantic versioning (e.g., '2.0.0' not '2.0'). Invalid versions cause 'skipping invalid skill' warnings during test execution.", "type": "fact", "importance": 0.8, "tags": ["skills", "versioning", "configuration"], "created_at": "2026-01-25T04:04:50.339375+00:00", "updated_at": "2026-01-25T04:04:50.339375+00:00", "source": "session", "source_id": "edd104f2-b2d8-4d31-a4fa-5799376ae6ec"}
{"id": "mm-9f86531f", "content": "Git logging tests require a caplog fixture configured with 'gobby.utils.git' logger. Use autouse fixture in conftest.py to configure caplog at the start of each test in test_utils_git.py to capture logger output properly.", "type": "pattern", "importance": 0.8, "tags": ["testing", "logging", "fixtures", "git"], "created_at": "2026-01-25T04:04:50.340569+00:00", "updated_at": "2026-01-25T04:04:50.340569+00:00", "source": "session", "source_id": "edd104f2-b2d8-4d31-a4fa-5799376ae6ec"}
{"id": "mm-010003b6", "content": "Async test methods in the gobby project must be decorated with `@pytest.mark.asyncio`. This is a project-wide convention that was missing from tests/workflows/test_task_enforcement.py in the TestBlockTools class.", "type": "pattern", "importance": 0.8, "tags": ["testing", "pytest", "async", "conventions"], "created_at": "2026-01-25T04:08:42.983058+00:00", "updated_at": "2026-01-25T04:08:42.983058+00:00", "source": "session", "source_id": "82c1590d-8051-4ccf-af2c-988867c7e884"}
{"id": "mm-41a61c2a", "content": "Memory ID generation in gobby uses '||' delimiter between content and project_id to prevent collisions (e.g., 'abc'+'def' vs 'abcd'+'ef'). This is implemented in src/gobby/storage/memories.py.", "type": "fact", "importance": 0.8, "tags": ["gobby", "memory-system", "id-generation", "collision-prevention"], "created_at": "2026-01-25T04:17:24.123650+00:00", "updated_at": "2026-01-25T04:17:24.123650+00:00", "source": "session", "source_id": "c9787d92-bd8e-4fcc-a158-05af9147f470"}
{"id": "mm-7d8398f5", "content": "The gobby project uses structured error codes via ToolProxyErrorCode enum (SERVER_NOT_FOUND, INVALID_ARGUMENTS, etc.) in src/gobby/mcp_proxy/models.py, with error classification in tool_proxy.py and backward-compatible fallback string matching in routes/mcp/tools.py.", "type": "pattern", "importance": 0.8, "tags": ["gobby", "error-handling", "mcp-proxy", "structured-errors"], "created_at": "2026-01-25T04:17:24.126037+00:00", "updated_at": "2026-01-25T04:17:24.126037+00:00", "source": "session", "source_id": "c9787d92-bd8e-4fcc-a158-05af9147f470"}
{"id": "mm-a74044c1", "content": "gobby syncs require timestamp normalization to ensure all timestamps have timezone suffix (appends 'Z' if missing in src/gobby/sync/tasks.py) and memory deduplication during export (src/gobby/sync/memories.py).", "type": "pattern", "importance": 0.8, "tags": ["gobby", "sync", "timestamps", "deduplication"], "created_at": "2026-01-25T04:17:24.126574+00:00", "updated_at": "2026-01-25T04:17:24.126574+00:00", "source": "session", "source_id": "c9787d92-bd8e-4fcc-a158-05af9147f470"}
{"id": "mm-402384de", "content": "Memory records with empty content should be rejected at creation time via validation in create_memory(). The .gobby/memories.jsonl file should not contain entries with null or empty content fields.", "type": "pattern", "importance": 0.8, "tags": ["validation", "memories", "data-integrity"], "created_at": "2026-01-25T04:34:46.439811+00:00", "updated_at": "2026-01-25T04:34:46.439811+00:00", "source": "session", "source_id": "0c5227bc-84b1-44b2-9e75-32fd96ec85ca"}
{"id": "mm-245807b9", "content": "The gobby project uses specific LiteLLM exception handling (AuthenticationError, NotFoundError, RateLimitError, ContextWindowExceededError) instead of broad exception catching in the embeddings module. Apply specific exception types in LiteLLM integration code.", "type": "pattern", "importance": 0.8, "tags": ["error-handling", "litellm", "embeddings"], "created_at": "2026-01-25T04:34:46.441061+00:00", "updated_at": "2026-01-25T04:34:46.441061+00:00", "source": "session", "source_id": "0c5227bc-84b1-44b2-9e75-32fd96ec85ca"}
