{"id": "mm-6138c752", "content": "The gobby project uses a two-tier workflow architecture: auto-task-claude.yaml (parent orchestrator in Claude Code) spawns Gemini workers in worktrees using gobby-agents.spawn_agent, while work-task-gemini.yaml (child worker) runs on spawned Gemini agents with lifecycle: get_session → claim_task → work → commit → close_task → report_to_parent. The older meeseeks-box.yaml and meeseeks.yaml files were deleted and replaced by these workflows.", "type": "fact", "importance": 0.95, "tags": ["workflow-architecture", "auto-task-claude", "work-task-gemini", "agent-spawning"], "created_at": "2026-01-28T20:38:12.074109+00:00", "updated_at": "2026-01-29T00:00:00.000000+00:00", "source": "session", "source_id": "8cc46e99-2e03-41f8-ba7e-7ad372450e56"}
{"id": "mm-98648f97", "content": "Gobby uses Pydantic BaseModel for config classes (e.g., SkillsConfig in config/skills.py) and dataclasses for storage models (e.g., Skill in storage/skills.py with source_type, source_path, source_ref fields). Provider abstractions follow ABC pattern with @abstractmethod decorators, matching the LLMProvider style in llm/base.py.", "type": "pattern", "importance": 0.95, "tags": ["architecture", "config", "providers", "models"], "created_at": "2026-01-28T20:13:58.013845+00:00", "updated_at": "2026-01-28T20:13:58.013845+00:00", "source": "session", "source_id": "0c872236-ce01-4ecd-912b-6afdc5dd393f"}
{"id": "mm-345741a5", "content": "The gobby project has significant documentation drift: mcp-tools.md documents only ~20-30% of actual tools (9 entire categories missing), cli-commands.md is missing 13+ command groups, tasks.md documents non-existent tools (expand_task, apply_tdd, analyze_complexity), and memory.md has incorrect tool names (remember→create_memory, add→create). Accuracy fixes should be prioritized before creating new documentation.", "type": "context", "importance": 0.95, "tags": ["documentation", "gobby", "accuracy-issues", "priority"], "created_at": "2026-01-28T16:21:49.019112+00:00", "updated_at": "2026-01-28T16:21:49.019112+00:00", "source": "session", "source_id": "1cd214d0-1e0d-4983-a94a-93a041119ba5"}
{"id": "mm-39112358", "content": "The gobby project uses a 'Strangler Fig' refactoring pattern to decompose monolithic modules into smaller, focused components. Phase 1 decomposes session_messages.py into a sessions/ package with specialized modules (_handoff.py, _messages.py, _crud.py, _commits.py, _factory.py). Phase 2 refactors MemoryManager into component classes (SearchCoordinator, MultimodalIngestor, CrossrefService). Phase 3 extracts task_enforcement_actions.py into an enforcement/ package with blocking.py, commit_policy.py, task_policy.py.", "type": "fact", "importance": 0.95, "tags": ["architecture", "refactoring", "decomposition", "strangler-fig"], "created_at": "2026-01-28T01:59:09.435744+00:00", "updated_at": "2026-01-28T01:59:09.435744+00:00", "source": "session", "source_id": "d6068bb9-78b2-4941-9de3-e4e4fe940a4f"}
{"id": "mm-a1360b29", "content": "Gobby project uses strangler-fig decomposition pattern to refactor large modules. Current targets: actions.py (<400 lines, 49 wrappers remain), tools.py (<100 lines), codex.py (<200 lines), migrations.py (flatten with legacy). Implementation follows /gobby plan skill with Root epic → Phase epics → Feature tasks hierarchy.", "type": "context", "importance": 0.95, "tags": ["gobby", "refactoring", "architecture", "strangler-fig"], "created_at": "2026-01-26T23:05:30.973935+00:00", "updated_at": "2026-01-26T23:05:30.973935+00:00", "source": "session", "source_id": "c939a49c-67ad-433f-bc8f-defdac852772"}
{"id": "mm-fad146df", "content": "Plan files in `.gobby/plans/` must follow expand-ready format: tasks need explicit `(category: code|config|test|docs|refactor|research|planning|manual)` annotations, `(depends: TaskName)` or `(depends: Phase N)` dependency notation, and a Task Mapping table at the bottom for task references. The `/g expand` command uses this format to auto-generate TDD triplets for code/config tasks.", "type": "pattern", "importance": 0.95, "tags": ["gobby", "plan-format", "expand-command", "task-structure"], "created_at": "2026-01-26T22:18:20.049027+00:00", "updated_at": "2026-01-26T22:18:20.049027+00:00", "source": "session", "source_id": "1b365507-fea8-4662-a6c5-62caef8f48ea"}
{"id": "mm-ef920a2b", "content": "Gobby's spawn architecture uses three spawner types (TerminalSpawner, EmbeddedSpawner, HeadlessSpawner) from spawn.py. Agent isolation is handled by WorktreeGitManager and CloneGitManager, with ~350 lines of duplicated spawn logic in spawn_agent_in_worktree and ~300 lines in spawn_agent_in_clone that should be unified.", "type": "fact", "importance": 0.95, "tags": ["architecture", "spawn-system", "git-isolation", "refactoring-target"], "created_at": "2026-01-26T17:11:39.633055+00:00", "updated_at": "2026-01-26T17:11:39.633055+00:00", "source": "session", "source_id": "8d582fd9-8c4b-48bf-949b-3d2f353527c9"}
{"id": "mm-5a96d183", "content": "Gobby project uses a unified installer that copies CLI-specific commands via install_cli_content(). Each CLI has its own directory: Claude uses Markdown in src/gobby/install/claude/commands/ → .claude/commands/, Gemini uses TOML in src/gobby/install/gemini/commands/ → .gemini/commands/, and Codex uses Markdown in src/gobby/install/codex/prompts/ → .codex/prompts/.", "type": "fact", "importance": 0.95, "tags": ["architecture", "installer", "multi-cli", "file-paths"], "created_at": "2026-01-26T15:19:56.014629+00:00", "updated_at": "2026-01-26T15:19:56.014629+00:00", "source": "session", "source_id": "1f0eb083-9ebd-4c61-8ea3-0e9fd78037e2"}
{"id": "mm-1398a1ab", "content": "The gobby project uses a unified spawn_agent API design with these key parameters: prompt (required), agent='generic' (default), isolation='current'|'worktree'|'clone'. Anonymous spawning defaults to 'generic' agent which uses bundled generic-agent.yaml and generic-workflow.yaml templates.", "type": "fact", "importance": 0.95, "tags": ["spawn_agent", "API_design", "gobby", "agent_spawning"], "created_at": "2026-01-26T14:05:26.282092+00:00", "updated_at": "2026-01-26T14:05:26.282092+00:00", "source": "session", "source_id": "dc91e716-6e3a-4958-a18f-599e9bc18341"}
{"id": "mm-a3743a20", "content": "The gobby project uses a multi-CLI installation model with four supported CLIs: Claude, Gemini, Codex, and Antigravity. Workflow files must be maintained in three locations: source shared version (src/gobby/install/shared/workflows/), installed versions for each CLI (.claude/, .gemini/, .codex/, .antigravity/), and project-level versions (.gobby/workflows/).", "type": "fact", "importance": 0.95, "tags": ["architecture", "file-organization", "installation", "multi-cli"], "created_at": "2026-01-26T02:57:07.741841+00:00", "updated_at": "2026-01-26T02:57:07.741841+00:00", "source": "session", "source_id": "1d0c2cb9-eb49-4dc2-8480-b01ade18895e"}
{"id": "mm-052d36a2", "content": "In gobby's logging configuration, setup_file_logging() sets propagate=False on the gobby package logger to prevent duplicate logs. This breaks pytest's caplog fixture because caplog captures via root logger handlers and depends on propagation. Tests need either a fixture enabling propagate=True during test execution, or should avoid using caplog.at_level(logger='gobby.utils.git') in favor of capturing all logs.", "type": "context", "importance": 0.95, "tags": ["logging", "testing", "caplog", "pytest", "gobby-logger-config"], "created_at": "2026-01-25T20:04:09.517652+00:00", "updated_at": "2026-01-25T20:04:09.517652+00:00", "source": "session", "source_id": "4042c9be-18da-4d31-9039-027a93af8c78"}
{"id": "mm-3eb24810", "content": "The gobby project is transitioning workflows from global (~/.gobby/workflows/) to project-only (.gobby/workflows/) storage. This requires removing global_dirs defaults from WorkflowLoader, eliminating --global flags from CLI, and removing is_global parameters from MCP tools across: loader.py, hook_manager.py, cli/workflows.py, mcp_proxy/tools/workflows.py, and cli/installers/codex.py.", "type": "context", "importance": 0.95, "tags": ["workflows", "architecture-change", "refactoring-scope"], "created_at": "2026-01-25T18:46:30.280702+00:00", "updated_at": "2026-01-25T18:46:30.280702+00:00", "source": "session", "source_id": "598eabaa-1caa-40d8-8166-309b8ff8ba9c"}
{"id": "mm-86377881", "content": "gobby-skills is the single source of truth for bundled skills. It contains 24 skills total: 17 original gobby-* skills (gobby-agents, gobby-clones, gobby-diagnostic, gobby-expand, gobby-mcp, gobby-memory, gobby-merge, gobby-metrics, gobby-plan, gobby-sessions, gobby-tasks, gobby-workflows, gobby-worktrees) + 5 helper skills (claiming-tasks, committing-changes, discovering-tools, starting-sessions) + 7 quick task skills (bug, chore, epic, eval, feat, nit, ref). Duplicate skill directories in .claude/skills/gobby-* and .claude/commands/gobby/ should be deleted to maintain single source of truth.", "type": "fact", "importance": 0.95, "tags": ["gobby-skills", "architecture", "skill-organization"], "created_at": "2026-01-25T18:18:01.196567+00:00", "updated_at": "2026-01-25T18:18:01.196567+00:00", "source": "session", "source_id": "8ba09a43-3c3f-442c-9cdf-555cb2f38851"}
{"id": "mm-414c0ecb", "content": "Claude Code doesn't include tool_result in post-tool-use hooks, causing detection_helpers.py to receive empty tool_output dicts. This breaks error detection in detect_task_claim for close_task validation - when close_task fails validation (e.g., 'no_commits_linked'), the empty tool_output passes all error checks and incorrectly clears task_claimed=False.", "type": "fact", "importance": 0.95, "tags": ["claude-code-limitation", "detection_helpers", "close_task", "task_claimed", "bug-root-cause"], "created_at": "2026-01-25T17:14:28.198509+00:00", "updated_at": "2026-01-25T17:14:28.198509+00:00", "source": "session", "source_id": "b08118fe-cfa2-4c04-b92a-d381c05e7eda"}
{"id": "mm-a9c13ab0", "content": "Gobby requires explicit task claiming before file edits are permitted. Use create_task with claim: true parameter or claim_task tool to enable write access. The hook system enforces this via PreToolUse validation.", "type": "pattern", "importance": 0.95, "tags": ["task-management", "workflow", "write-access", "hooks"], "created_at": "2026-01-25T17:02:58.234367+00:00", "updated_at": "2026-01-25T17:02:58.234367+00:00", "source": "session", "source_id": "510d507d-f02a-47d5-8b8c-5c8fc2299ab3"}
{"id": "mm-05096ffa", "content": "The gobby project is standardizing session_id format to 'Accept #N' across the codebase. This involves updating tool definitions, implementation code, and documentation—32 tools were identified that need updates as part of this standardization effort.", "type": "context", "importance": 0.9, "tags": ["gobby", "session_id-standardization", "ongoing-work"], "created_at": "2026-01-29T17:41:53.873807+00:00", "updated_at": "2026-01-29T17:41:53.873807+00:00", "source": "session", "source_id": "a506fc5b-8ab1-46b2-a51d-70c731443a33"}
{"id": "mm-ada82a24", "content": "The gobby project uses a task-based workflow where changes must be claimed via task IDs before committing. Task claims are made through an MCP tool, and commits should reference the task number in the message format '[#TASKID]'.", "type": "pattern", "importance": 0.9, "tags": ["workflow", "git", "task-management"], "created_at": "2026-01-29T15:05:42.799407+00:00", "updated_at": "2026-01-29T15:05:42.799407+00:00", "source": "session", "source_id": "e8e5ef51-6442-48e1-9e5a-c95723d12bc1"}
{"id": "mm-72ab3f43", "content": "Task workflow in gobby requires creating/claiming a task before making changes, then committing changes with the task ID in the commit message (format: [#TASK_ID]), and finally marking the task complete via MCP tool.", "type": "pattern", "importance": 0.9, "tags": ["workflow", "git", "task-management"], "created_at": "2026-01-29T03:54:49.065617+00:00", "updated_at": "2026-01-29T03:54:49.065617+00:00", "source": "session", "source_id": "a8a64d5c-0dcf-4d6e-ae47-45eda0c13d26"}
{"id": "mm-2475e827", "content": "Task workflow requires explicit closure: when a task is in_progress, the stop hook will fail with a message directing to close_task before the session can complete. Git commits should reference task IDs in the format '[#XXXX]'.", "type": "pattern", "importance": 0.9, "tags": ["task-management", "workflow", "git-conventions"], "created_at": "2026-01-29T03:40:03.793250+00:00", "updated_at": "2026-01-29T03:40:03.793250+00:00", "source": "session", "source_id": "ba79f495-984c-4cc8-92be-6c352b431d15"}
{"id": "mm-e15e1397", "content": "In the gobby project, when launching a gemini CLI instance in ghostty, the session_id and external_id are automatically available to the instance without needing to be passed as parameters. Avoid over-complicating the spawn flow by passing these values explicitly.", "type": "pattern", "importance": 0.9, "tags": ["gobby", "gemini-cli", "ghostty", "architecture", "spawn-flow"], "created_at": "2026-01-29T03:06:57.021504+00:00", "updated_at": "2026-01-29T03:06:57.021504+00:00", "source": "session", "source_id": "832f7376-6505-444d-bb24-f5d60d15b922"}
{"id": "mm-9e7df56a", "content": "The gobby project uses a plugin system (HookPlugin) with hook handlers for BEFORE_TOOL and AFTER_TOOL events. Plugins register workflow actions and conditions, and can enforce code quality checks (ruff, mypy) with auto-fix capabilities.", "type": "fact", "importance": 0.9, "tags": ["gobby", "architecture", "plugins", "hooks"], "created_at": "2026-01-29T02:47:50.778081+00:00", "updated_at": "2026-01-29T02:47:50.778081+00:00", "source": "session", "source_id": "0955b7ef-8dd8-487b-bf7d-27a707d8789d"}
{"id": "mm-d6e6113c", "content": "Gobby project uses a daemon architecture with skill management. Skills are stored in ~/.claude/skills/ directory with SKILL.md files. The daemon needs to be restarted after deleting stale skill references to trigger re-syncing from the authoritative source at src/gobby/install/shared/skills/.", "type": "fact", "importance": 0.9, "tags": ["gobby", "architecture", "daemon", "skills", "file-structure"], "created_at": "2026-01-28T21:50:47.415993+00:00", "updated_at": "2026-01-28T21:50:47.415993+00:00", "source": "session", "source_id": "bf024d3e-66a5-4af6-a500-ac36456674a3"}
{"id": "mm-1bc61281", "content": "The gobby task system provides `wait_for_task(task_id, timeout=600, poll_interval=5.0)` tool that blocks a parent agent until a child task reaches 'closed' status. This tool handles internal polling at the specified interval, eliminating the need for manual polling loops in the meeseeks-box workflow pattern.", "type": "fact", "importance": 0.9, "tags": ["gobby-tasks", "wait_for_task", "task-coordination", "meeseeks-box"], "created_at": "2026-01-28T21:21:37.660206+00:00", "updated_at": "2026-01-28T21:21:37.660206+00:00", "source": "session", "source_id": "19a449c7-bfa1-4882-825f-16bc3709efa0"}
{"id": "mm-cbca3b4b", "content": "The meeseeks-box workflow pattern for parent-child task coordination is: (1) spawn_agent() to create child, (2) wait_for_task() to block until child completes, (3) poll_messages() to retrieve child's completion report, (4) check task_tree_complete to determine if loop should continue.", "type": "pattern", "importance": 0.9, "tags": ["meeseeks-box", "workflow-pattern", "task-coordination"], "created_at": "2026-01-28T21:21:37.661274+00:00", "updated_at": "2026-01-28T21:21:37.661274+00:00", "source": "session", "source_id": "19a449c7-bfa1-4882-825f-16bc3709efa0"}
{"id": "mm-da5ac7f0", "content": "Gobby uses database migrations with a BASELINE_VERSION constant and numbered migration tuples. Migrations are stored in src/gobby/storage/migrations.py. The database schema version is tracked in a migrations table with timestamps. When the database version falls behind BASELINE_VERSION or available migrations, the application will error with 'Database version X is older than baseline Y'.", "type": "fact", "importance": 0.9, "tags": ["database", "migrations", "architecture"], "created_at": "2026-01-28T21:18:50.288890+00:00", "updated_at": "2026-01-28T21:18:50.288890+00:00", "source": "session", "source_id": "b9ce4431-a610-4889-a33d-877ba34aba2e"}
