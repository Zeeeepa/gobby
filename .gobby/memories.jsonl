{"id": "mm-c26da176", "content": "The gobby project has a memory deduplication bug: IDs are generated from content + project_id, but inconsistent project_id values (sometimes None) cause identical content to receive different IDs, bypassing deduplication. This results in ~50% of memories being duplicates with different hashes.", "type": "context", "importance": 0.95, "tags": ["bug", "memory-system", "deduplication", "critical"], "created_at": "2026-01-25T00:07:01.247597+00:00", "updated_at": "2026-01-25T00:07:01.247597+00:00", "source": "session", "source_id": "ff9fe45c-40e4-4d1e-b275-0ffcc43113c4"}
{"id": "mm-d26eacfd", "content": "The gobby project has a memory deduplication bug: IDs are generated from content + project_id, but inconsistent project_id values (sometimes None) cause identical content to receive different IDs, bypassing deduplication. This results in ~50% of memories being duplicates with different hashes.", "type": "context", "importance": 0.95, "tags": ["bug", "memory-system", "deduplication", "critical"], "created_at": "2026-01-24T23:52:43.922346+00:00", "updated_at": "2026-01-24T23:52:43.922346+00:00", "source": "session", "source_id": "ff9fe45c-40e4-4d1e-b275-0ffcc43113c4"}
{"id": "mm-5e40e17d", "content": "The gobby project has a hook system (hook_dispatcher.py) that enforces pre-tool validation. When writing files, the PreToolUse hook must complete successfully before file operations are allowed. Tasks must be created via mcp__gobby__call_tool before writing to protected files like plans.", "type": "pattern", "importance": 0.9, "tags": ["gobby", "hooks", "task-management", "file-operations"], "created_at": "2026-01-25T00:53:10.697107+00:00", "updated_at": "2026-01-25T00:53:10.697107+00:00", "source": "session", "source_id": "940ab854-c09e-4cee-bfbc-b18b55c5e6d6"}
{"id": "mm-ac12eb07", "content": "The gobby project has a hook system (hook_dispatcher.py) that enforces pre-tool validation. When writing files, the PreToolUse hook must complete successfully before file operations are allowed. Tasks must be created via mcp__gobby__call_tool before writing to protected files like plans.", "type": "pattern", "importance": 0.9, "tags": ["gobby", "hooks", "task-management", "file-operations"], "created_at": "2026-01-25T00:52:31.873661+00:00", "updated_at": "2026-01-25T00:52:31.873661+00:00", "source": "session", "source_id": "940ab854-c09e-4cee-bfbc-b18b55c5e6d6"}
{"id": "mm-87f251cf", "content": "Memory deduplication in gobby uses normalized content (stripped whitespace) to generate IDs via generate_prefixed_id('mm', normalized_content + project_str), but content_exists() in storage/memories.py compares against raw stored content. This mismatch causes duplicate detection to fail when content has extra whitespace. Fix: normalize inputs in content_exists() with strip() before DB comparison to match ID generation behavior.", "type": "pattern", "importance": 0.9, "tags": ["memory-system", "deduplication", "bug-fix", "content-hashing"], "created_at": "2026-01-25T00:35:51.541413+00:00", "updated_at": "2026-01-25T00:35:51.541413+00:00", "source": "session", "source_id": "2d818bad-d27e-477a-a7c3-6614521c559c"}
{"id": "mm-e08da539", "content": "The session-lifecycle.yaml workflow blocks close_task when require_commit_before_close=true, task_has_commits=false, and commit_sha is missing. However, documented edge-case reasons ('already_implemented', 'obsolete', 'duplicate', 'wont_fix') should bypass this requirement. The when condition must also check that tool_input.get('reason') is NOT in the allowed values to properly implement the edge-case flow.", "type": "pattern", "importance": 0.9, "tags": ["workflow", "task-lifecycle", "condition-logic", "edge-cases"], "created_at": "2026-01-25T00:35:51.539301+00:00", "updated_at": "2026-01-25T00:35:51.539301+00:00", "source": "session", "source_id": "2d818bad-d27e-477a-a7c3-6614521c559c"}
{"id": "mm-e742c90b", "content": "The session-lifecycle.yaml workflow blocks close_task when require_commit_before_close=true, task_has_commits=false, and commit_sha is missing. However, documented edge-case reasons ('already_implemented', 'obsolete', 'duplicate', 'wont_fix') should bypass this requirement. The when condition must also check that tool_input.get('reason') is NOT in the allowed values to properly implement the edge-case flow.", "type": "pattern", "importance": 0.9, "tags": ["workflow", "task-lifecycle", "condition-logic", "edge-cases"], "created_at": "2026-01-25T00:35:11.302238+00:00", "updated_at": "2026-01-25T00:35:11.302238+00:00", "source": "session", "source_id": "2d818bad-d27e-477a-a7c3-6614521c559c"}
{"id": "mm-c8231f38", "content": "Memory deduplication in gobby uses normalized content (stripped whitespace) to generate IDs via generate_prefixed_id('mm', normalized_content + project_str), but content_exists() in storage/memories.py compares against raw stored content. This mismatch causes duplicate detection to fail when content has extra whitespace. Fix: normalize inputs in content_exists() with strip() before DB comparison to match ID generation behavior.", "type": "pattern", "importance": 0.9, "tags": ["memory-system", "deduplication", "bug-fix", "content-hashing"], "created_at": "2026-01-25T00:35:11.300828+00:00", "updated_at": "2026-01-25T00:35:11.300828+00:00", "source": "session", "source_id": "2d818bad-d27e-477a-a7c3-6614521c559c"}
{"id": "mm-fde51f14", "content": "The gobby project uses skip reasons (like reason=\"obsolete\") in close_task() instead of escape hatches like no_commit_needed. This is the preferred pattern for closing tasks without requiring commits.", "type": "pattern", "importance": 0.9, "tags": ["task-lifecycle", "close_task", "API-pattern"], "created_at": "2026-01-25T00:27:49.311643+00:00", "updated_at": "2026-01-25T00:27:49.311643+00:00", "source": "session", "source_id": "fc7aa685-5c27-40b2-9994-17597388cb8a"}
{"id": "mm-04c06f62", "content": "The gobby project uses skip reasons (like reason=\"obsolete\") in close_task() instead of escape hatches like no_commit_needed. This is the preferred pattern for closing tasks without requiring commits.", "type": "pattern", "importance": 0.9, "tags": ["task-lifecycle", "close_task", "API-pattern"], "created_at": "2026-01-25T00:26:55.541046+00:00", "updated_at": "2026-01-25T00:26:55.541046+00:00", "source": "session", "source_id": "fc7aa685-5c27-40b2-9994-17597388cb8a"}
{"id": "mm-1c34a692", "content": "The gobby project uses a `close_task` lifecycle tool with a `reason` parameter that accepts SKIP_REASONS: {\"duplicate\", \"already_implemented\", \"wont_fix\", \"obsolete\"}. This parameter is the intended escape hatch for edge cases instead of using a `no_commit_needed` flag, which the team is removing to enforce proper commit-based workflows.", "type": "fact", "importance": 0.9, "tags": ["gobby", "close_task", "lifecycle", "architecture"], "created_at": "2026-01-25T00:09:28.351842+00:00", "updated_at": "2026-01-25T00:09:28.351842+00:00", "source": "session", "source_id": "034f0f0a-f7d3-4a3b-b86d-1741a32b7516"}
{"id": "mm-64a4ac15", "content": "The gobby project uses a `close_task` lifecycle tool with a `reason` parameter that accepts SKIP_REASONS: {\"duplicate\", \"already_implemented\", \"wont_fix\", \"obsolete\"}. This parameter is the intended escape hatch for edge cases instead of using a `no_commit_needed` flag, which the team is removing to enforce proper commit-based workflows.", "type": "fact", "importance": 0.9, "tags": ["gobby", "close_task", "lifecycle", "architecture"], "created_at": "2026-01-25T00:09:01.848937+00:00", "updated_at": "2026-01-25T00:09:01.848937+00:00", "source": "session", "source_id": "034f0f0a-f7d3-4a3b-b86d-1741a32b7516"}
{"id": "mm-7da9f3e2", "content": "The gobby project uses an MCP tool calling system with result processing logic. A `_process_tool_proxy_result` helper function consolidates duplicate result-processing logic used by both `call_mcp_tool` (line 508) and `mcp_proxy` (line 1101) endpoints. The helper handles metrics collection, error handling (raising HTTPException(404) for missing servers), debug logging, and returns a wrapped result dict with success/result/response_time_ms fields.", "type": "fact", "importance": 0.9, "tags": ["architecture", "tool-normalization", "adapters", "block-rules"], "created_at": "2026-01-25T00:07:01.257871+00:00", "updated_at": "2026-01-25T00:07:01.257871+00:00", "source": "session", "source_id": "3d7faf43-6ef1-48a3-91f4-c04c55be51b8"}
{"id": "mm-dac38ef1", "content": "The gobby project uses tool name normalization across adapters, with Claude Code (CC) names as canonical: Read, Write, Edit. Gemini adapter already implements this normalization; Codex adapter needs it added. Block rules should check against these normalized canonical names to remain CLI-agnostic.", "type": "fact", "importance": 0.9, "tags": ["architecture", "tool-normalization", "adapters", "block-rules"], "created_at": "2026-01-25T00:07:01.253482+00:00", "updated_at": "2026-01-25T00:07:01.253482+00:00", "source": "session", "source_id": "3d7faf43-6ef1-48a3-91f4-c04c55be51b8"}
{"id": "mm-b6618b4e", "content": "Gobby uses workflow state detection to track task lifecycle. The `task_claimed` variable is set when tasks are claimed and must be preserved if `close_task()` fails. State clearing happens in the MCP proxy's `close_task` function (in `_lifecycle.py`), not in detection helpers, because Claude Code doesn't include `tool_result` in post-tool-use hooks for MCP calls.", "type": "fact", "importance": 0.9, "tags": ["workflow-state", "task-lifecycle", "mcp-proxy", "claude-code-limitations"], "created_at": "2026-01-25T00:07:01.252718+00:00", "updated_at": "2026-01-25T00:07:01.252718+00:00", "source": "session", "source_id": "9ee2d23a-69d2-47e4-bd7b-002c848da563"}
{"id": "mm-e058504c", "content": "Plan mode detection in Gobby must handle two entry paths: (1) programmatic `EnterPlanMode` tool calls tracked via `detect_task_claim()`, and (2) UI-based entry detected via system reminders in the prompt (tracked via `detect_plan_mode_from_context()` in BEFORE_AGENT hooks). Both update the `plan_mode` variable in workflow state.", "type": "pattern", "importance": 0.9, "tags": ["plan-mode", "detection-helpers", "lifecycle-evaluator", "workflow-state"], "created_at": "2026-01-25T00:07:01.251913+00:00", "updated_at": "2026-01-25T00:07:01.251913+00:00", "source": "session", "source_id": "9ee2d23a-69d2-47e4-bd7b-002c848da563"}
{"id": "mm-47b54d46", "content": "The gobby project uses a task management system where tasks must be claimed before modifying plan files. Attempting to write to plan files without a claimed task triggers hook errors. Always call the task claim tool before writing plan updates.", "type": "pattern", "importance": 0.9, "tags": ["gobby", "workflow", "task-system", "plan-files"], "created_at": "2026-01-25T00:07:01.251182+00:00", "updated_at": "2026-01-25T00:07:01.251182+00:00", "source": "session", "source_id": "5b9e2bd6-2c41-493a-b9c0-229eb1058ede"}
{"id": "mm-ee060ff2", "content": "To fix the deduplication bug: (1) normalize content before hashing (strip whitespace, lowercase), (2) add content_exists() check before storing new memories, (3) investigate why project_id is sometimes None vs populated, (4) cleanup existing duplicates by grouping normalized content and keeping oldest entries.", "type": "pattern", "importance": 0.9, "tags": ["bug-fix", "memory-system", "deduplication"], "created_at": "2026-01-25T00:07:01.250422+00:00", "updated_at": "2026-01-25T00:07:01.250422+00:00", "source": "session", "source_id": "ff9fe45c-40e4-4d1e-b275-0ffcc43113c4"}
{"id": "mm-b67a21a3", "content": "The gobby project uses workflow variables in `session-lifecycle.yaml` to configure task lifecycle policies, including `require_commit_before_close`, `block_no_commit_with_dirty`, and `clear_task_on_close`. The `_lifecycle.py` module enforces these policies.", "type": "fact", "importance": 0.9, "tags": ["architecture", "lifecycle", "configuration"], "created_at": "2026-01-25T00:07:01.249489+00:00", "updated_at": "2026-01-25T00:07:01.249489+00:00", "source": "session", "source_id": "77772daa-920c-4261-85e5-0fea2725d03a"}
{"id": "mm-72e677da", "content": "The gobby project uses workflow variables in `session-lifecycle.yaml` to configure task lifecycle policies, including `require_commit_before_close`, `block_no_commit_with_dirty`, and `clear_task_on_close`. The `_lifecycle.py` module enforces these policies.", "type": "fact", "importance": 0.9, "tags": ["architecture", "lifecycle", "configuration"], "created_at": "2026-01-24T23:54:34.181627+00:00", "updated_at": "2026-01-24T23:54:34.181627+00:00", "source": "session", "source_id": "77772daa-920c-4261-85e5-0fea2725d03a"}
{"id": "mm-4b4e0c31", "content": "To fix the deduplication bug: (1) normalize content before hashing (strip whitespace, lowercase), (2) add content_exists() check before storing new memories, (3) investigate why project_id is sometimes None vs populated, (4) cleanup existing duplicates by grouping normalized content and keeping oldest entries.", "type": "pattern", "importance": 0.9, "tags": ["bug-fix", "memory-system", "deduplication"], "created_at": "2026-01-24T23:52:43.924492+00:00", "updated_at": "2026-01-24T23:52:43.924492+00:00", "source": "session", "source_id": "ff9fe45c-40e4-4d1e-b275-0ffcc43113c4"}
{"id": "mm-de0de42c", "content": "The gobby project uses a task management system where tasks must be claimed before modifying plan files. Attempting to write to plan files without a claimed task triggers hook errors. Always call the task claim tool before writing plan updates.", "type": "pattern", "importance": 0.9, "tags": ["gobby", "workflow", "task-system", "plan-files"], "created_at": "2026-01-24T23:35:55.713827+00:00", "updated_at": "2026-01-24T23:35:55.713827+00:00", "source": "session", "source_id": "5b9e2bd6-2c41-493a-b9c0-229eb1058ede"}
{"id": "mm-e1f2c88c", "content": "Plan mode detection in Gobby must handle two entry paths: (1) programmatic `EnterPlanMode` tool calls tracked via `detect_task_claim()`, and (2) UI-based entry detected via system reminders in the prompt (tracked via `detect_plan_mode_from_context()` in BEFORE_AGENT hooks). Both update the `plan_mode` variable in workflow state.", "type": "pattern", "importance": 0.9, "tags": ["plan-mode", "detection-helpers", "lifecycle-evaluator", "workflow-state"], "created_at": "2026-01-24T23:23:40.092040+00:00", "updated_at": "2026-01-24T23:23:40.092040+00:00", "source": "session", "source_id": "9ee2d23a-69d2-47e4-bd7b-002c848da563"}
{"id": "mm-38aff4af", "content": "Gobby uses workflow state detection to track task lifecycle. The `task_claimed` variable is set when tasks are claimed and must be preserved if `close_task()` fails. State clearing happens in the MCP proxy's `close_task` function (in `_lifecycle.py`), not in detection helpers, because Claude Code doesn't include `tool_result` in post-tool-use hooks for MCP calls.", "type": "fact", "importance": 0.9, "tags": ["workflow-state", "task-lifecycle", "mcp-proxy", "claude-code-limitations"], "created_at": "2026-01-24T23:23:40.090803+00:00", "updated_at": "2026-01-24T23:23:40.090803+00:00", "source": "session", "source_id": "9ee2d23a-69d2-47e4-bd7b-002c848da563"}
{"id": "mm-2988eb19", "content": "The gobby project uses tool name normalization across adapters, with Claude Code (CC) names as canonical: Read, Write, Edit. Gemini adapter already implements this normalization; Codex adapter needs it added. Block rules should check against these normalized canonical names to remain CLI-agnostic.", "type": "fact", "importance": 0.9, "tags": ["architecture", "tool-normalization", "adapters", "block-rules"], "created_at": "2026-01-24T23:22:20.742549+00:00", "updated_at": "2026-01-24T23:22:20.742549+00:00", "source": "session", "source_id": "3d7faf43-6ef1-48a3-91f4-c04c55be51b8"}
{"id": "mm-598d0d3b", "content": "Memory deduplication in `src/gobby/storage/memories.py` requires consistent normalization: both `create_memory()` and `content_exists()` must use the same ID generation logic (normalizing content with `.strip()` before hashing) to avoid duplicate memory creation from whitespace differences.", "type": "pattern", "importance": 0.85, "tags": ["deduplication", "memory_storage", "consistency"], "created_at": "2026-01-25T00:48:07.239221+00:00", "updated_at": "2026-01-25T00:48:07.239221+00:00", "source": "session", "source_id": "85973c23-679f-462a-8e15-e07d8ceb5bf0"}
{"id": "mm-da554a8b", "content": "Memory deduplication in `src/gobby/storage/memories.py` requires consistent normalization: both `create_memory()` and `content_exists()` must use the same ID generation logic (normalizing content with `.strip()` before hashing) to avoid duplicate memory creation from whitespace differences.", "type": "pattern", "importance": 0.85, "tags": ["deduplication", "memory_storage", "consistency"], "created_at": "2026-01-25T00:47:16.550176+00:00", "updated_at": "2026-01-25T00:47:16.550176+00:00", "source": "session", "source_id": "85973c23-679f-462a-8e15-e07d8ceb5bf0"}
{"id": "mm-2b81abb2", "content": "Memory storage layer in src/gobby/storage/memories.py uses generate_prefixed_id('mm', content + str(project_id)) for content-hash based deduplication. The manager layer (src/gobby/memory/manager.py) intentionally relies on this storage-level dedup rather than implementing its own.", "type": "fact", "importance": 0.85, "tags": ["architecture", "memory-system", "file-locations"], "created_at": "2026-01-25T00:27:49.315176+00:00", "updated_at": "2026-01-25T00:27:49.315176+00:00", "source": "session", "source_id": "ff9fe45c-40e4-4d1e-b275-0ffcc43113c4"}
{"id": "mm-485e5816", "content": "Refactoring `no_commit_needed` parameter out of close_task requires updating tests across multiple files: test_tasks_coverage.py (remove 3 tests + schema assertion), test_validation_integration.py, test_task_id_resolution.py, test_sequential_review_loop.py, and test_parallel_clones.py. Tests using `no_commit_needed` should be rewritten to use `reason=\"obsolete\"` or deleted.", "type": "pattern", "importance": 0.85, "tags": ["gobby", "testing", "refactoring", "close_task"], "created_at": "2026-01-25T00:09:28.353450+00:00", "updated_at": "2026-01-25T00:09:28.353450+00:00", "source": "session", "source_id": "034f0f0a-f7d3-4a3b-b86d-1741a32b7516"}
{"id": "mm-d3fa7f69", "content": "Refactoring `no_commit_needed` parameter out of close_task requires updating tests across multiple files: test_tasks_coverage.py (remove 3 tests + schema assertion), test_validation_integration.py, test_task_id_resolution.py, test_sequential_review_loop.py, and test_parallel_clones.py. Tests using `no_commit_needed` should be rewritten to use `reason=\"obsolete\"` or deleted.", "type": "pattern", "importance": 0.85, "tags": ["gobby", "testing", "refactoring", "close_task"], "created_at": "2026-01-25T00:09:01.852025+00:00", "updated_at": "2026-01-25T00:09:01.852025+00:00", "source": "session", "source_id": "034f0f0a-f7d3-4a3b-b86d-1741a32b7516"}
{"id": "mm-81bf68d2", "content": "Gobby enforces fail-fast error handling: when parent_task_id resolution fails in task operations, the code should raise ValueError with logged warnings rather than silently falling back to invalid references. Always chain exceptions using `raise ... from e` for context preservation.", "type": "pattern", "importance": 0.85, "tags": ["error-handling", "logging", "exception-chaining"], "created_at": "2026-01-25T00:07:01.257157+00:00", "updated_at": "2026-01-25T00:07:01.257157+00:00", "source": "session", "source_id": "42f21ae1-f0a6-46c0-b86d-f97b6b34cd91"}
{"id": "mm-fa8bff8f", "content": "Tool name normalization strategy: different CLI tools use different naming conventions (e.g., read_file vs Read). Solution is to normalize all tool names to CC-style canonical names before matching against block rules, making rules independent of which CLI adapter is being used.", "type": "pattern", "importance": 0.85, "tags": ["design-pattern", "abstraction", "adapter-pattern"], "created_at": "2026-01-25T00:07:01.256421+00:00", "updated_at": "2026-01-25T00:07:01.256421+00:00", "source": "session", "source_id": "3d7faf43-6ef1-48a3-91f4-c04c55be51b8"}
{"id": "mm-1ca39c13", "content": "Gobby's error messages and tool descriptions actively teach agent behavior patterns. The `close_task(task_id, commit_sha='...')` pattern should be presented as the primary/recommended approach in: (1) error message for `no_commits_linked`, (2) `close_task` tool description leading with `commit_sha`, and (3) `commit_sha` param marked as 'RECOMMENDED'. `link_commit` is an edge case for linking without closing.", "type": "preference", "importance": 0.85, "tags": ["deterministic-workflows", "agent-training", "error-messages", "tool-descriptions"], "created_at": "2026-01-25T00:07:01.255623+00:00", "updated_at": "2026-01-25T00:07:01.255623+00:00", "source": "session", "source_id": "9ee2d23a-69d2-47e4-bd7b-002c848da563"}
{"id": "mm-df51c864", "content": "Gobby is dogfooding its own workflow system: agents running under Gobby should follow the patterns being built in the system. When unexpected agent behavior is observed, it indicates the error messages, tool descriptions, or documentation need updating to teach the correct pattern, not that the agent is wrong.", "type": "context", "importance": 0.85, "tags": ["gobby-philosophy", "system-design", "agent-behavior"], "created_at": "2026-01-25T00:07:01.254857+00:00", "updated_at": "2026-01-25T00:07:01.254857+00:00", "source": "session", "source_id": "9ee2d23a-69d2-47e4-bd7b-002c848da563"}
{"id": "mm-f39a7116", "content": "Memory storage layer in src/gobby/storage/memories.py uses generate_prefixed_id('mm', content + str(project_id)) for content-hash based deduplication. The manager layer (src/gobby/memory/manager.py) intentionally relies on this storage-level dedup rather than implementing its own.", "type": "fact", "importance": 0.85, "tags": ["architecture", "memory-system", "file-locations"], "created_at": "2026-01-25T00:07:01.254183+00:00", "updated_at": "2026-01-25T00:07:01.254183+00:00", "source": "session", "source_id": "ff9fe45c-40e4-4d1e-b275-0ffcc43113c4"}
{"id": "mm-92b5bbae", "content": "Memory storage layer in src/gobby/storage/memories.py uses generate_prefixed_id('mm', content + str(project_id)) for content-hash based deduplication. The manager layer (src/gobby/memory/manager.py) intentionally relies on this storage-level dedup rather than implementing its own.", "type": "fact", "importance": 0.85, "tags": ["architecture", "memory-system", "file-locations"], "created_at": "2026-01-24T23:52:43.923727+00:00", "updated_at": "2026-01-24T23:52:43.923727+00:00", "source": "session", "source_id": "ff9fe45c-40e4-4d1e-b275-0ffcc43113c4"}
{"id": "mm-9a961623", "content": "Gobby is dogfooding its own workflow system: agents running under Gobby should follow the patterns being built in the system. When unexpected agent behavior is observed, it indicates the error messages, tool descriptions, or documentation need updating to teach the correct pattern, not that the agent is wrong.", "type": "context", "importance": 0.85, "tags": ["gobby-philosophy", "system-design", "agent-behavior"], "created_at": "2026-01-24T23:23:40.095935+00:00", "updated_at": "2026-01-24T23:23:40.095935+00:00", "source": "session", "source_id": "9ee2d23a-69d2-47e4-bd7b-002c848da563"}
{"id": "mm-84c8949a", "content": "Gobby's error messages and tool descriptions actively teach agent behavior patterns. The `close_task(task_id, commit_sha='...')` pattern should be presented as the primary/recommended approach in: (1) error message for `no_commits_linked`, (2) `close_task` tool description leading with `commit_sha`, and (3) `commit_sha` param marked as 'RECOMMENDED'. `link_commit` is an edge case for linking without closing.", "type": "preference", "importance": 0.85, "tags": ["deterministic-workflows", "agent-training", "error-messages", "tool-descriptions"], "created_at": "2026-01-24T23:23:40.092605+00:00", "updated_at": "2026-01-24T23:23:40.092605+00:00", "source": "session", "source_id": "9ee2d23a-69d2-47e4-bd7b-002c848da563"}
{"id": "mm-ed18a4a3", "content": "Tool name normalization strategy: different CLI tools use different naming conventions (e.g., read_file vs Read). Solution is to normalize all tool names to CC-style canonical names before matching against block rules, making rules independent of which CLI adapter is being used.", "type": "pattern", "importance": 0.85, "tags": ["design-pattern", "abstraction", "adapter-pattern"], "created_at": "2026-01-24T23:22:20.744117+00:00", "updated_at": "2026-01-24T23:22:20.744117+00:00", "source": "session", "source_id": "3d7faf43-6ef1-48a3-91f4-c04c55be51b8"}
{"id": "mm-c8f1dfde", "content": "Gobby enforces fail-fast error handling: when parent_task_id resolution fails in task operations, the code should raise ValueError with logged warnings rather than silently falling back to invalid references. Always chain exceptions using `raise ... from e` for context preservation.", "type": "pattern", "importance": 0.85, "tags": ["error-handling", "logging", "exception-chaining"], "created_at": "2026-01-24T22:57:16.000006+00:00", "updated_at": "2026-01-24T22:57:16.000006+00:00", "source": "session", "source_id": "42f21ae1-f0a6-46c0-b86d-f97b6b34cd91"}
{"id": "mm-549dd820", "content": "The gobby project uses an MCP tool calling system with result processing logic. A `_process_tool_proxy_result` helper function consolidates duplicate result-processing logic used by both `call_mcp_tool` (line 508) and `mcp_proxy` (line 1101) endpoints. The helper handles metrics collection, error handling (raising HTTPException(404) for missing servers), debug logging, and returns a wrapped result dict with success/result/response_time_ms fields.", "type": "fact", "importance": 0.85, "tags": ["architecture", "mcp-tools", "code-organization"], "created_at": "2026-01-24T22:53:17.925868+00:00", "updated_at": "2026-01-24T22:53:17.925868+00:00", "source": "session", "source_id": "746edd21-a30a-4fa6-aa40-ffa51ba4527d"}
{"id": "mm-5067cc5d", "content": "The gobby project uses JSONL format for storing memories and tasks (.gobby/tasks.jsonl, memories.jsonl). The memory export code correctly uses `json.dumps(data, ensure_ascii=False) + \"\\n\"` format. Past corruption issues in memories.jsonl appear to be from previous sessions rather than export code bugs.", "type": "fact", "importance": 0.8, "tags": ["gobby", "persistence", "memories", "jsonl", "data-format"], "created_at": "2026-01-25T00:53:10.701133+00:00", "updated_at": "2026-01-25T00:53:10.701133+00:00", "source": "session", "source_id": "940ab854-c09e-4cee-bfbc-b18b55c5e6d6"}
{"id": "mm-d1c4dcc6", "content": "Gobby supports optional dependency syntax for pip installation (e.g., `pip install gobby[mem0]` for mem0ai integration). When documenting installation of optional features, use the bracket syntax rather than listing packages separately.", "type": "pattern", "importance": 0.8, "tags": ["gobby", "dependencies", "documentation", "mem0"], "created_at": "2026-01-25T00:53:10.699877+00:00", "updated_at": "2026-01-25T00:53:10.699877+00:00", "source": "session", "source_id": "940ab854-c09e-4cee-bfbc-b18b55c5e6d6"}
{"id": "mm-88c21a5e", "content": "Gobby supports optional dependency syntax for pip installation (e.g., `pip install gobby[mem0]` for mem0ai integration). When documenting installation of optional features, use the bracket syntax rather than listing packages separately.", "type": "pattern", "importance": 0.8, "tags": ["gobby", "dependencies", "documentation", "mem0"], "created_at": "2026-01-25T00:52:31.874408+00:00", "updated_at": "2026-01-25T00:52:31.874408+00:00", "source": "session", "source_id": "940ab854-c09e-4cee-bfbc-b18b55c5e6d6"}
{"id": "mm-96f29b22", "content": "The gobby project uses JSONL format for storing memories and tasks (.gobby/tasks.jsonl, memories.jsonl). The memory export code correctly uses `json.dumps(data, ensure_ascii=False) + \"\\n\"` format. Past corruption issues in memories.jsonl appear to be from previous sessions rather than export code bugs.", "type": "fact", "importance": 0.8, "tags": ["gobby", "persistence", "memories", "jsonl", "data-format"], "created_at": "2026-01-25T00:52:31.872890+00:00", "updated_at": "2026-01-25T00:52:31.872890+00:00", "source": "session", "source_id": "940ab854-c09e-4cee-bfbc-b18b55c5e6d6"}
{"id": "mm-f5179f33", "content": "The gobby project uses restricted eval() in `_evaluate_block_condition` for condition evaluation with limited `allowed_globals`. The `not in` operator and list literals work correctly in this restricted context without being explicitly added to allowed_globals.", "type": "fact", "importance": 0.8, "tags": ["security", "eval", "task_enforcement"], "created_at": "2026-01-25T00:48:07.255356+00:00", "updated_at": "2026-01-25T00:48:07.255356+00:00", "source": "session", "source_id": "85973c23-679f-462a-8e15-e07d8ceb5bf0"}
{"id": "mm-535e99f5", "content": "The `close_task` blocking rule in session-lifecycle.yaml uses a `when` condition that allows edge-case close reasons (`already_implemented`, `obsolete`, `duplicate`, `wont_fix`) to bypass commit requirements. This enables closing tasks without linking commits when using these specific reasons.", "type": "context", "importance": 0.8, "tags": ["task_enforcement", "workflow", "close_task"], "created_at": "2026-01-25T00:48:07.253941+00:00", "updated_at": "2026-01-25T00:48:07.253941+00:00", "source": "session", "source_id": "85973c23-679f-462a-8e15-e07d8ceb5bf0"}
{"id": "mm-8d4a86ed", "content": "The `close_task` blocking rule in session-lifecycle.yaml uses a `when` condition that allows edge-case close reasons (`already_implemented`, `obsolete`, `duplicate`, `wont_fix`) to bypass commit requirements. This enables closing tasks without linking commits when using these specific reasons.", "type": "context", "importance": 0.8, "tags": ["task_enforcement", "workflow", "close_task"], "created_at": "2026-01-25T00:47:16.551237+00:00", "updated_at": "2026-01-25T00:47:16.551237+00:00", "source": "session", "source_id": "85973c23-679f-462a-8e15-e07d8ceb5bf0"}
{"id": "mm-299bc37b", "content": "The gobby project uses restricted eval() in `_evaluate_block_condition` for condition evaluation with limited `allowed_globals`. The `not in` operator and list literals work correctly in this restricted context without being explicitly added to allowed_globals.", "type": "fact", "importance": 0.8, "tags": ["security", "eval", "task_enforcement"], "created_at": "2026-01-25T00:47:16.547297+00:00", "updated_at": "2026-01-25T00:47:16.547297+00:00", "source": "session", "source_id": "85973c23-679f-462a-8e15-e07d8ceb5bf0"}
