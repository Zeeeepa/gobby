{"id": "mm-86377881", "content": "gobby-skills (src/gobby/install/shared/skills/) is the single source of truth for bundled skills. It contains 24 skills total: 13 gobby-* skills (gobby-agents, gobby-clones, gobby-diagnostic, gobby-expand, gobby-mcp, gobby-memory, gobby-merge, gobby-metrics, gobby-plan, gobby-sessions, gobby-tasks, gobby-workflows, gobby-worktrees) + 4 helper skills (claiming-tasks, committing-changes, discovering-tools, starting-sessions) + 7 quick task skills (bug, chore, epic, eval, feat, nit, ref).", "type": "fact", "importance": 0.95, "tags": ["gobby-skills", "architecture", "skill-organization"], "created_at": "2026-01-25T18:18:01.196567+00:00", "updated_at": "2026-01-25T18:18:01.196567+00:00", "source": "session", "source_id": "8ba09a43-3c3f-442c-9cdf-555cb2f38851"}
{"id": "mm-414c0ecb", "content": "Claude Code doesn't include tool_result in post-tool-use hooks, causing detection_helpers.py to receive empty tool_output dicts. This breaks error detection in detect_task_claim for close_task validation - when close_task fails validation (e.g., 'no_commits_linked'), the empty tool_output passes all error checks and incorrectly clears task_claimed=False.", "type": "fact", "importance": 0.95, "tags": ["claude-code-limitation", "detection_helpers", "close_task", "task_claimed", "bug-root-cause"], "created_at": "2026-01-25T17:14:28.198509+00:00", "updated_at": "2026-01-25T17:14:28.198509+00:00", "source": "session", "source_id": "b08118fe-cfa2-4c04-b92a-d381c05e7eda"}
{"id": "mm-a9c13ab0", "content": "Gobby requires explicit task claiming before file edits are permitted. Use create_task with claim: true parameter or claim_task tool to enable write access. The hook system enforces this via PreToolUse validation.", "type": "pattern", "importance": 0.95, "tags": ["task-management", "workflow", "write-access", "hooks"], "created_at": "2026-01-25T17:02:58.234367+00:00", "updated_at": "2026-01-25T17:02:58.234367+00:00", "source": "session", "source_id": "510d507d-f02a-47d5-8b8c-5c8fc2299ab3"}
{"id": "mm-95982e24", "content": "LocalTaskManager.get_task() in src/gobby/storage/tasks/_manager.py accepts multiple task ID formats (UUID, #N, N notation) and resolves them internally, but direct comparisons between task.id (UUID) and claimed_task_id values fail if claimed_task_id stores non-UUID formats.", "type": "fact", "importance": 0.9, "tags": ["gobby", "task-management", "id-formats", "bug-pattern"], "created_at": "2026-01-25T18:19:24.503354+00:00", "updated_at": "2026-01-25T18:19:24.503354+00:00", "source": "session", "source_id": "3fe55f9e-069d-470f-ab2f-03ceaf53a6b0"}
{"id": "mm-1a26cb0a", "content": "Task ID comparison bugs exist at _lifecycle.py:199 (claimed_task_id == resolved_id) and task_enforcement_actions.py:963 (t.id == claimed_task_id). These fail when claimed_task_id contains refs like '#6066' instead of UUIDs. Fix: ensure claimed_task_id always stores resolved UUIDs at storage time.", "type": "context", "importance": 0.9, "tags": ["gobby", "bug-location", "task-ids", "comparison"], "created_at": "2026-01-25T18:19:24.504439+00:00", "updated_at": "2026-01-25T18:19:24.504439+00:00", "source": "session", "source_id": "3fe55f9e-069d-470f-ab2f-03ceaf53a6b0"}
{"id": "mm-4365aaba", "content": "In detection_helpers.py, the post-tool-use hook must guard against empty `tool_output` when processing `close_task` calls, as Claude Code doesn't include `tool_result` in post-tool-use hooks, which can cause incorrect state clearing (task_claimed flag). The MCP proxy's close_task already handles state clearing for successful closes.", "type": "pattern", "importance": 0.9, "tags": ["gobby", "detection_helpers.py", "state-management", "bug-prevention"], "created_at": "2026-01-25T17:17:47.890702+00:00", "updated_at": "2026-01-25T17:17:47.890702+00:00", "source": "session", "source_id": "10803605-e46c-4c09-8020-d6a4d5077a57"}
{"id": "mm-d7198491", "content": "Gobby has a skill bundling/syncing mechanism: `get_bundled_skills_path()` returns `src/gobby/install/shared/skills/` and `sync_bundled_skills()` loads all skills from that directory and creates them in the database if they don't exist. Skills must be in proper directory format (directory with SKILL.md).", "type": "fact", "importance": 0.9, "tags": ["gobby", "skills", "architecture", "bundling"], "created_at": "2026-01-25T17:40:17.813446+00:00", "updated_at": "2026-01-25T17:40:17.813446+00:00", "source": "session", "source_id": "a6b6cc75-b083-4183-827a-b05d51d5a1d3"}
{"id": "mm-8af0897e", "content": "In the gobby project's pytest test suite, caplog logging capture requires using `with caplog.at_level(logging.DEBUG, logger=\"module.name\"):` as a context manager around code that generates logs. Using `caplog.set_level()` in autouse fixtures does not properly capture logs and is a broken pattern.", "type": "pattern", "importance": 0.9, "tags": ["testing", "pytest", "caplog", "logging", "gobby"], "created_at": "2026-01-25T16:53:25.603590+00:00", "updated_at": "2026-01-25T16:53:25.603590+00:00", "source": "session", "source_id": "99afe6be-e662-4f5b-a6b0-6c8da124b366"}
{"id": "mm-e97a285c", "content": "The gobby project uses SQLite with custom datetime adapters. The `_adapt_datetime` function in `database.py` (line 24) uses `isoformat(\" \")` which produces space-separated timestamps like \"2026-01-25 01:43:54\" instead of ISO 8601 standard \"2026-01-25T01:43:54\". This non-standard format can cause timestamp normalization issues in exported JSONL files.", "type": "fact", "importance": 0.9, "tags": ["database", "datetime", "sqlite", "bug-source"], "created_at": "2026-01-25T03:58:56.473712+00:00", "updated_at": "2026-01-25T03:58:56.473712+00:00", "source": "session", "source_id": "8dfb36ae-572d-4a12-a667-0e710b658a2d"}
{"id": "mm-269f997a", "content": "Gobby uses ISO 8601 timestamps with 'T' separator (not space) in database and JSON files. The root cause of timestamp issues was using `isoformat(\" \")` instead of `isoformat()` in src/gobby/storage/database.py. When fixing timestamps, normalize existing data from space to T separator format.", "type": "fact", "importance": 0.9, "tags": ["timestamps", "database", "iso8601", "data-migration"], "created_at": "2026-01-25T04:02:56.261015+00:00", "updated_at": "2026-01-25T04:02:56.261015+00:00", "source": "session", "source_id": "1a867b59-ad3d-4075-9020-6293616fbeb2"}
{"id": "mm-5e7a4810", "content": "The gobby project uses a task management system with MCP tool `mcp__gobby__call_tool` for closing tasks. The close_task operation requires a 'reason' parameter (not 'resolution'), and task closure is only possible after commits are made with the commit SHA.", "type": "fact", "importance": 0.9, "tags": ["gobby", "task-management", "mcp-tools", "workflow"], "created_at": "2026-01-25T04:08:42.982283+00:00", "updated_at": "2026-01-25T04:08:42.982283+00:00", "source": "session", "source_id": "82c1590d-8051-4ccf-af2c-988867c7e884"}
{"id": "mm-10c7ed85", "content": "The gobby project uses a SafeExpressionEvaluator (AST-based) instead of eval() for security-critical expression evaluation in task enforcement actions. This pattern should be applied whenever dynamic expressions need evaluation.", "type": "pattern", "importance": 0.9, "tags": ["security", "task-enforcement", "expression-evaluation"], "created_at": "2026-01-25T04:34:46.436166+00:00", "updated_at": "2026-01-25T04:34:46.436166+00:00", "source": "session", "source_id": "0c5227bc-84b1-44b2-9e75-32fd96ec85ca"}
{"id": "mm-63a6a7ee", "content": "The gobby project stores claimed task IDs inconsistently (sometimes as refs, sometimes as UUIDs). Standardize by resolving all task ID references to UUIDs at storage time in create_task and detection_helpers.py, allowing safe direct comparisons elsewhere.", "type": "context", "importance": 0.85, "tags": ["gobby", "data-consistency", "task-ids"], "created_at": "2026-01-25T18:19:24.505350+00:00", "updated_at": "2026-01-25T18:19:24.505350+00:00", "source": "session", "source_id": "3fe55f9e-069d-470f-ab2f-03ceaf53a6b0"}
{"id": "mm-04c2b074", "content": "The gobby project uses an MCP proxy with a `close_task` function that handles state clearing for successful task closes. When calling this function via mcp__gobby__call_tool, use parameter 'reason' (not 'resolution') and provide the commit_sha for proper task closure.", "type": "fact", "importance": 0.85, "tags": ["gobby", "mcp", "task-management", "api-pattern"], "created_at": "2026-01-25T17:17:47.888770+00:00", "updated_at": "2026-01-25T17:17:47.888770+00:00", "source": "session", "source_id": "10803605-e46c-4c09-8020-d6a4d5077a57"}
{"id": "mm-84071e68", "content": "Gobby skills are duplicated across multiple CLI configuration directories: `.claude/`, `.codex/`, `.antigravity/`, and `.gemini/`. When consolidating skills, all four directories need to be checked and cleaned up to remove duplicates.", "type": "fact", "importance": 0.85, "tags": ["gobby", "skills", "cleanup", "multi-cli"], "created_at": "2026-01-25T17:40:17.816246+00:00", "updated_at": "2026-01-25T17:40:17.816246+00:00", "source": "session", "source_id": "a6b6cc75-b083-4183-827a-b05d51d5a1d3"}
{"id": "mm-7b530aea", "content": "The gobby MCP proxy's close_task function has validation checks (validate_commit_requirements) that return errors BEFORE the code that clears task_claimed state (lines 192-207). So the proxy itself doesn't clear task_claimed on validation failures - only on actual successful closes.", "type": "fact", "importance": 0.85, "tags": ["_lifecycle.py", "close_task", "state-management", "validation-flow"], "created_at": "2026-01-25T17:14:28.199456+00:00", "updated_at": "2026-01-25T17:14:28.199456+00:00", "source": "session", "source_id": "b08118fe-cfa2-4c04-b92a-d381c05e7eda"}
{"id": "mm-099c9ea0", "content": "In gobby's detection_helpers.py, when handling close_task in the AFTER_TOOL hook (lines 67-81), the function should NOT clear task_claimed if tool_output is empty, since it cannot verify whether the close actually succeeded. The MCP proxy's close_task handles clearing task_claimed for genuine successes.", "type": "pattern", "importance": 0.85, "tags": ["detection_helpers", "close_task", "task_claimed", "fix-strategy"], "created_at": "2026-01-25T17:14:28.200002+00:00", "updated_at": "2026-01-25T17:14:28.200002+00:00", "source": "session", "source_id": "b08118fe-cfa2-4c04-b92a-d381c05e7eda"}
{"id": "mm-5c262953", "content": "The gobby-tasks skill has a `claim` parameter (boolean, default false) that must be explicitly set to `true` to auto-claim a task (set assignee to session_id and status to in_progress). Documentation examples should always include this parameter when demonstrating auto-claim behavior.", "type": "fact", "importance": 0.85, "tags": ["gobby-tasks", "API", "create_task", "claim-parameter"], "created_at": "2026-01-25T17:05:36.798926+00:00", "updated_at": "2026-01-25T17:05:36.798926+00:00", "source": "session", "source_id": "14783fc8-c1c8-4670-9bdc-0a1849c5376d"}
{"id": "mm-a4f17d3e", "content": "Spawned subagents must use gobby-sessions.get_current() to retrieve session_id and agent_run_id, communicate via gobby-agents.send_to_parent(), and terminate with gobby-agents.kill_agent(run_id). Never use CLI commands like /quit for agent termination.", "type": "pattern", "importance": 0.85, "tags": ["agent-protocol", "subagent-communication", "lifecycle-management"], "created_at": "2026-01-25T17:02:58.236794+00:00", "updated_at": "2026-01-25T17:02:58.236794+00:00", "source": "session", "source_id": "510d507d-f02a-47d5-8b8c-5c8fc2299ab3"}
{"id": "mm-06c2e32f", "content": "gobby-tasks.list_tasks() returns results in result.get('results', []) not result.get('tasks', []). When filtering for __diag__ artifacts in cleanup, iterate over result.get('results', []) and check task.get('title', '').startswith('__diag__'), then call close_task(task_id=task['id'], reason='obsolete') or delete_task(task_id=task['id']) for each match.", "type": "fact", "importance": 0.85, "tags": ["gobby-tasks", "api-patterns", "cleanup", "MCP-tools"], "created_at": "2026-01-25T04:38:01.651928+00:00", "updated_at": "2026-01-25T04:38:01.651928+00:00", "source": "session", "source_id": "389037ea-8953-4e4f-bcb4-29c5dc468357"}
{"id": "mm-5d78c5cf", "content": "The gobby project has 14 test failures across 4 categories: session message tests (3), git logging tests (10), skill version warnings (2), and E2E daemon timeout (1). Session tests need assertions updated from 'Session enhanced by gobby' to check for 'Gobby Session ID:' and 'External ID:'. Git logging tests require a caplog autouse fixture to capture the gobby.utils.git logger.", "type": "context", "importance": 0.85, "tags": ["test-failures", "gobby", "debugging"], "created_at": "2026-01-25T03:55:11.338525+00:00", "updated_at": "2026-01-25T03:55:11.338525+00:00", "source": "session", "source_id": "f41bfbd1-8db4-4411-af15-7986f3249da4"}
{"id": "mm-44e91fb4", "content": "The gobby project has a `TaskSyncManager` that handles export from SQLite to JSONL format, triggered via CLI command `gobby tasks sync --export`. Timestamps are written as-is from the database without normalization during export, so fixing timestamps at the database level (via SQL normalization) is more effective than post-processing the JSONL file.", "type": "fact", "importance": 0.85, "tags": ["architecture", "cli", "export", "workflow"], "created_at": "2026-01-25T03:58:56.475053+00:00", "updated_at": "2026-01-25T03:58:56.475053+00:00", "source": "session", "source_id": "8dfb36ae-572d-4a12-a667-0e710b658a2d"}
{"id": "mm-5b4c8326", "content": "In cli/tasks/_utils.py, get_claimed_task_ids() correctly resolves task refs to UUIDs before comparisonâ€”this pattern should be applied to other modules that store or compare task IDs.", "type": "pattern", "importance": 0.8, "tags": ["gobby", "id-resolution", "best-practice"], "created_at": "2026-01-25T18:32:33.164319+00:00", "updated_at": "2026-01-25T18:32:33.164319+00:00", "source": "session", "source_id": "3fe55f9e-069d-470f-ab2f-03ceaf53a6b0"}
