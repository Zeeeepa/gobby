{"id": "mm-b43447eb", "content": "Josh Wilhelmi is Gobby's creator and primary developer. He goes by Josh.", "type": "fact", "importance": 0.9, "tags": "identity, creator, josh", "created_at": "2026-02-09T01:52:28.946058+00:00", "updated_at": "2026-02-09T01:52:28.946058+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-78b3b992", "content": "Step and pipeline workflows do not replace lifecycle workflows: they run concurrently. The primary difference between the workflow types is that you can have multiple lifecycle workflows running in a session but only one step or one pipeline workflow active at a time in a session.", "type": "fact", "importance": 0.9, "tags": "workflows, lifecycle, step, pipeline, concurrency", "created_at": "2026-02-06T16:17:35.575620+00:00", "updated_at": "2026-02-06T16:17:35.575620+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-90e1218d", "content": "Session detail endpoint GET /sessions/{id} returns session.to_dict() which does NOT include computed fields like message_count. The list endpoint GET /sessions enriches with message_count from session_messages table. Any new computed fields must be added to both endpoints. Fixed in sessions.py by adding get_all_counts() enrichment to the detail endpoint.", "type": "pattern", "importance": 8.0, "tags": ["web-ui", "sessions", "api", "backend"], "created_at": "2026-02-11T16:36:35.130284+00:00", "updated_at": "2026-02-11T16:36:35.130284+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-98ef118d", "content": "Gobby web frontend is at /web/ (React 18 + TypeScript + Vite). Single CSS file at web/src/styles/index.css (~196KB). Components in web/src/components/, hooks in web/src/hooks/. API proxy to daemon on localhost:60887, WebSocket on localhost:60888.", "type": "fact", "importance": 7.0, "tags": ["web-ui", "frontend", "architecture"], "created_at": "2026-02-11T16:36:06.188022+00:00", "updated_at": "2026-02-11T16:36:06.188022+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-6d8d6a6e", "content": "The _personal project name is mapped to 'Personal' in App.tsx (line 86). This causes UI confusion when components use project names as labels - any toggle or display showing 'Personal' may collide with the _personal project name. The ChatInput scope toggle was redesigned to use fixed 'Personal'/'Project' labels with a search dropdown instead of showing project names directly.", "type": "pattern", "importance": 6.0, "tags": ["web-ui", "projects", "gotcha"], "created_at": "2026-02-11T16:36:54.327240+00:00", "updated_at": "2026-02-11T16:36:54.327240+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-9921888e", "content": "tmux rename-window only changes the tmux status bar name. To propagate the window name to the outer terminal emulator (e.g. Antigravity sidebar), you must also enable `set-titles on` globally. Additionally, disable `automatic-rename off` per-window to prevent tmux from overwriting the title on the next command. DANGER: Never write raw OSC escape sequences to the tmux client TTY (/dev/ttysNNN) — this injects bytes into tmux's input stream and can kill the terminal window.", "type": "insight", "importance": 2.0, "tags": ["tmux", "terminal", "gotcha"], "created_at": "2026-02-12T19:00:31.217035+00:00", "updated_at": "2026-02-12T19:00:31.217035+00:00", "source": "mcp_tool", "source_id": "fdbe93cd-b8d2-4a91-a9bb-596077e30e6d"}
{"id": "mm-f565acb6", "content": "To set config values in Gobby's DB-first config store at runtime: PUT http://localhost:60887/api/config/values with {\"values\": {\"key.path\": \"value\"}}. Returns {\"ok\": true, \"requires_restart\": true} when a daemon restart is needed.", "type": "insight", "importance": 2.0, "tags": ["config", "rest-api", "config-store"], "created_at": "2026-02-12T18:52:31.864028+00:00", "updated_at": "2026-02-12T18:52:31.864028+00:00", "source": "mcp_tool", "source_id": "8ca08fd5-9b9c-43f3-880a-6f59cb806d05"}
{"id": "mm-70dc425c", "content": "mem0 Docker healthcheck: The mem0/mem0-api-server base image does NOT include curl. Use Python urllib for healthchecks instead: [\"CMD\", \"python\", \"-c\", \"import urllib.request; urllib.request.urlopen('http://localhost:8000/')\"]", "type": "insight", "importance": 2.0, "tags": ["mem0", "docker", "healthcheck"], "created_at": "2026-02-12T18:52:03.665057+00:00", "updated_at": "2026-02-12T18:52:03.665057+00:00", "source": "mcp_tool", "source_id": "8ca08fd5-9b9c-43f3-880a-6f59cb806d05"}
{"id": "mm-b74031a5", "content": "Mem0 Docker setup: The mem0/mem0-api-server Docker Hub image is missing critical dependencies for postgres+neo4j usage. Must extend with mem0ai[graph,vector-stores] and psycopg[binary,pool] extras. The image's main.py reads POSTGRES_HOST/USER/PASSWORD/DB and NEO4J_URI/USERNAME/PASSWORD env vars (NOT MEM0_* style). Needs /app/history volume for SQLite history. Internal port is 8000.", "type": "technical", "importance": 2.0, "tags": ["mem0", "docker", "gotcha"], "created_at": "2026-02-12T17:06:40.330275+00:00", "updated_at": "2026-02-12T17:06:40.330275+00:00", "source": "mcp_tool", "source_id": "9ff21bbd-e29c-4e5a-b928-7264ca1fd6df"}
{"id": "mm-cdcacb06", "content": "The Claude Code `Skill` tool only knows about skills registered directly with Claude Code (via .claude/commands/ or built-in). Gobby skills (expand, tasks, memory, etc.) are discovered via gobby-skills MCP server and injected through hooks — they are NOT in Claude Code's native skill registry. Never use the Skill tool to invoke gobby skills; they're routed through the /gobby command's hook interception in _agent.py.", "type": "insight", "importance": 2.0, "tags": ["skills", "claude-code", "architecture"], "created_at": "2026-02-12T15:26:36.693010+00:00", "updated_at": "2026-02-12T15:26:36.693010+00:00", "source": "mcp_tool", "source_id": "9db8b4a1-ad65-4ddf-b8b2-cb412f5e42b6"}
{"id": "mm-c372066d", "content": "The /gobby skill routing in _agent.py uses regex `^/gobby(?::(\\S+))?\\s*(.*)?$` which only captures skill names after a colon (/gobby:expand), not after a space (/gobby expand). Fixed by adding fallback logic: when skill_name is None but args is non-empty, check if the first word of args resolves to a valid skill via resolve_skill_name(). If so, treat it as the skill name. File: src/gobby/hooks/event_handlers/_agent.py, method _intercept_skill_command().", "type": "insight", "importance": 2.0, "tags": ["skills", "routing", "hooks", "bugfix"], "created_at": "2026-02-12T15:25:57.802577+00:00", "updated_at": "2026-02-12T15:25:57.802577+00:00", "source": "mcp_tool", "source_id": "9db8b4a1-ad65-4ddf-b8b2-cb412f5e42b6"}
{"id": "mm-0c61bd9e", "content": "Bug: RegistryContext in src/gobby/mcp_proxy/tools/tasks/_context.py line 123 had self.db instead of self.task_manager.db. RegistryContext has no db attribute - it accesses the database through task_manager.db (see __post_init__ line 59). This broke any gobby-tasks MCP tool that calls resolve_project_filter (list_tasks, save_expansion_spec, etc). Fixed in commit 70a74b4d.", "type": "debugging", "importance": 2.0, "tags": ["bug", "mcp-proxy", "tasks", "registry-context"], "created_at": "2026-02-11T18:02:15.762293+00:00", "updated_at": "2026-02-11T18:02:15.762293+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-ded108b9", "content": "Gobby 3D knowledge graph display requires neo4j_url and neo4j_auth in ~/.gobby/config.yaml under the memory section. The web UI checks /admin/status for memory.neo4j.configured before showing the KnowledgeGraph tab. The Neo4j instance runs on port 8474 (HTTP) from mem0's docker compose, with auth neo4j:mem0graph.", "type": "technical", "importance": 1.0, "tags": ["neo4j", "config", "web-ui"], "created_at": "2026-02-12T17:12:09.152762+00:00", "updated_at": "2026-02-12T17:12:09.152762+00:00", "source": "mcp_tool", "source_id": "9ff21bbd-e29c-4e5a-b928-7264ca1fd6df"}
{"id": "mm-d5dd8c01", "content": "Gobby _mem0_start() in daemon.py now resolves OPENAI_API_KEY from the SecretStore and injects it into the docker compose subprocess env. This keeps the API key out of .env files and off disk. The flow: instantiate LocalDatabase + SecretStore from config, call secret_store.get('OPENAI_API_KEY'), pass via env dict to subprocess.run(). The compose file references ${OPENAI_API_KEY} which gets resolved from the subprocess environment.", "type": "technical", "importance": 1.0, "tags": ["mem0", "secrets", "architecture"], "created_at": "2026-02-12T17:06:26.561096+00:00", "updated_at": "2026-02-12T17:06:26.561096+00:00", "source": "mcp_tool", "source_id": "9ff21bbd-e29c-4e5a-b928-7264ca1fd6df"}
{"id": "mm-8f0bc4be", "content": "We don't do workarounds, we log and fix bugs. When encountering a bug, document it and fix it rather than working around it.", "type": "preference", "importance": 1.0, "tags": "development,bugs,workflow", "created_at": "2026-02-05T02:09:03.761109+00:00", "updated_at": "2026-02-05T02:09:03.761109+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-430eb283", "content": "Claude Agents SDK (claude_agent_sdk / ClaudeSDKClient) does not fire SessionStart hooks. This means the session-lifecycle workflow never initializes via on_session_start triggers — variables like enforce_tool_schema_check, unlocked_tools, and servers_listed are never set, so all on_before_tool enforcement (progressive disclosure, task-before-edit) is bypassed. The fix for dev mode is to use _find_project_root() to set the correct cwd in ChatSession.start(). For production, a UI project picker is needed to bootstrap the session before chatting.", "type": "fact", "importance": 0.95, "tags": "agents-sdk,hooks,session-start,chat-session,enforcement", "created_at": "2026-02-09T04:02:23.943085+00:00", "updated_at": "2026-02-09T04:02:23.943085+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-052d36a2", "content": "In gobby's logging configuration, setup_file_logging() sets propagate=False on the gobby package logger to prevent duplicate logs. This breaks pytest's caplog fixture because caplog captures via root logger handlers and depends on propagation. Tests need either a fixture enabling propagate=True during test execution, or should avoid using caplog.at_level(logger='gobby.utils.git') in favor of capturing all logs.", "type": "context", "importance": 0.95, "tags": ["logging", "testing", "caplog", "pytest", "gobby-logger-config"], "created_at": "2026-01-25T20:04:09.517652+00:00", "updated_at": "2026-01-25T20:04:09.517652+00:00", "source": "session", "source_id": "4042c9be-18da-4d31-9039-027a93af8c78"}
{"id": "mm-3860c4e5", "content": "Claude Code doesn't include tool_result in post-tool-use hooks, causing detection_helpers.py to receive empty tool_output dicts. This breaks error detection in detect_task_claim for close_task validation - when close_task fails validation (e.g., 'no_commits_linked'), the empty tool_output passes all error checks and incorrectly clears task_claimed=False.", "type": "fact", "importance": 0.95, "tags": ["claude-code-limitation", "detection_helpers", "close_task", "task_claimed", "bug-root-cause"], "created_at": "2026-01-25T17:15:06.972227+00:00", "updated_at": "2026-01-25T17:15:06.972227+00:00", "source": "session", "source_id": "b08118fe-cfa2-4c04-b92a-d381c05e7eda"}
{"id": "mm-502d11c3", "content": "BASELINE_SCHEMA must be kept in sync with BASELINE_VERSION. When bumping BASELINE_VERSION, audit ALL migrations between the old and new version for: (1) ALTER TABLE ADD COLUMN statements — add columns to the baseline table definition, (2) CREATE TABLE statements — add new tables to baseline, (3) INSERT statements for seed data — add to baseline. The migration guard for existing databases should check against _MIN_MIGRATION_VERSION (the first migration in the MIGRATIONS list, currently 76), NOT BASELINE_VERSION. These serve different purposes: BASELINE_VERSION controls fresh DB schema, _MIN_MIGRATION_VERSION controls the upgrade cutoff for existing DBs.", "type": "insight", "importance": 0.9, "tags": ["migrations", "baseline", "schema", "debugging"], "created_at": "2026-02-13T00:57:14.876440+00:00", "updated_at": "2026-02-13T00:57:14.876440+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-19ea3692", "content": "Bug in memory_review_gate: The MCP set_variable tool's value param is typed as string, so setting value.", "type": "fact", "importance": 0.9, "tags": ["bug", "mcp", "call_tool", "workaround"], "created_at": "2026-02-13T00:25:47.310070+00:00", "updated_at": "2026-02-13T00:25:47.310070+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-ec42538a", "content": "Antigravity (VS Code fork) terminal sidebar shows 'tmux' for all terminals by default because `terminal.integrated.tabs.title` defaults to `${process}`. To display tmux window names (set via `set-titles` + `set-titles-string`), change the setting to `${sequence}`. The setting is in `~/Library/Application Support/Antigravity/User/settings.json`. The `set-titles-string` format controls what tmux emits via OSC — consider using just `#W` (window name) for clean sidebar labels instead of the verbose default `#S:#I:#W - \"#T\" #{session_alerts}`.", "type": "insight", "importance": 0.9, "tags": ["antigravity", "vscode", "tmux", "terminal", "configuration"], "created_at": "2026-02-13T00:25:47.299016+00:00", "updated_at": "2026-02-13T00:25:47.299016+00:00", "source": "mcp_tool", "source_id": "2c404415-4523-4d88-b820-0802a8dfaedb"}
{"id": "mm-94fa07d5", "content": "NEVER add startup code that kills other processes on ports. _clear_port() using lsof + SIGTERM was added to GobbyRunner.run() to handle orphaned test daemons, but it caused e2e tests to kill the production daemon. The correct approach to port isolation is preventing collisions at allocation time (find_free_port without SO_REUSEADDR + excluded ports), not killing processes at startup.", "type": "fact", "importance": 0.9, "tags": ["architecture-decision", "anti-pattern", "port-isolation", "runner"], "created_at": "2026-02-12T21:00:05.722499+00:00", "updated_at": "2026-02-12T21:00:05.722499+00:00", "source": "mcp_tool", "source_id": "432c9580-9d9f-46ca-9c22-ad02bfc2d171"}
{"id": "mm-53aa67dc", "content": "CRITICAL: Use `uv run gobby` instead of `gobby` for development! The system-wide `gobby` CLI (`~/.local/bin/gobby`) uses a global uv tools install that may be outdated. Always use `uv run gobby start` to run the daemon from the local development environment. Commands: `uv run gobby start` (start daemon), `uv run gobby stop` (stop), `uv run gobby restart` (restart).", "type": "pattern", "importance": 0.9, "tags": ["development", "environment", "cli"], "created_at": "2026-02-12T19:33:43.658840+00:00", "updated_at": "2026-02-12T19:33:43.658840+00:00", "source": "mcp_tool", "source_id": "4552a4b4-25cd-4850-b649-29cff6320a00"}
{"id": "mm-d6692a3e", "content": "Antigravity (VS Code fork) terminal sidebar shows 'tmux' for all terminals by default because `terminal.integrated.tabs.title` defaults to `${process}`. To display tmux window names (set via `set-titles` + `set-titles-string`), change the setting to `${sequence}`. The setting is in `~/Library/Application Support/Antigravity/User/settings.json`. The `set-titles-string` format controls what tmux emits via OSC — consider using just `#W` (window name) for clean sidebar labels instead of the verbose default `#S:#I:#W - \"#T\" #{session_alerts}`.", "type": "insight", "importance": 0.9, "tags": ["antigravity", "vscode", "tmux", "terminal", "configuration"], "created_at": "2026-02-12T19:10:17.862084+00:00", "updated_at": "2026-02-12T19:10:17.862084+00:00", "source": "mcp_tool", "source_id": "2c404415-4523-4d88-b820-0802a8dfaedb"}
{"id": "mm-c630e784", "content": "Mem0 container health check fails because Dockerfile uses `curl` without installing it first. Both source (/gobby/services/mem0/Dockerfile) and installed copy have identical issue: `curl` command in healthcheck but not in RUN pip install. Fix requires adding `curl` to apt-get or using `python -m http.client` alternative.", "type": "fact", "importance": 0.9, "tags": ["mem0", "docker", "healthcheck", "bug", "blocking"], "created_at": "2026-02-12T18:50:55.036630+00:00", "updated_at": "2026-02-12T18:50:55.036630+00:00", "source": "session", "source_id": "4f4bc972-1c3c-41ef-b0d1-20c8b4730655"}
{"id": "mm-80124865", "content": "Mem0 container health check fails because Dockerfile uses `curl` without `-f` flag. The curl command returns HTTP 200 even on application errors, so unhealthy containers report as healthy. Fix: add `-f` flag to curl in health check (e.g., `curl -f http://localhost:8000/health`). Affects both source Dockerfile and installed copies.", "type": "fact", "importance": 0.9, "tags": ["mem0", "docker", "health-check", "bug", "critical"], "created_at": "2026-02-12T18:47:51.213244+00:00", "updated_at": "2026-02-12T18:47:51.213244+00:00", "source": "session", "source_id": "4f4bc972-1c3c-41ef-b0d1-20c8b4730655"}
{"id": "mm-afca4dda", "content": "The `create_memory` function had a foreign key constraint error due to not correctly handling the `#N` shorthand for session IDs.", "type": "fact", "importance": 0.9, "tags": ["create_memory", "bug", "foreign_key"], "created_at": "2026-02-12T04:58:11.315760+00:00", "updated_at": "2026-02-12T04:58:11.315760+00:00", "source": "session", "source_id": "971fbce6-9aeb-4001-9097-8d3b11e63b18"}
{"id": "mm-07319c65", "content": "The gobby MCP call_tool tool parameter is named \"arguments\" (not \"args\"). When calling mcp__gobby__call_tool, pass nested tool arguments as \"arguments\": {\"key\": \"value\"}, NOT \"args\". FastMCP validates parameter names strictly and rejects unknown parameters.", "type": "fact", "importance": 0.9, "tags": ["bug", "mcp", "call_tool", "workaround"], "created_at": "2026-02-11T19:44:47.928108+00:00", "updated_at": "2026-02-11T19:58:15.162753+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-1e9e86e7", "content": "Plans should not have open questions or unresolved options. Settle all decisions before presenting a plan for approval. Josh doesn't like being asked to choose between options at the end — resolve them during the planning discussion.", "type": "preference", "importance": 0.9, "tags": ["planning", "workflow", "preference"], "created_at": "2026-02-11T17:21:48.375243+00:00", "updated_at": "2026-02-11T17:21:48.375243+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-52b47f5b", "content": "Bug in memory_review_gate: The MCP set_variable tool's value param is typed as string, so setting value=\"false\" stores the string \"false\" which is truthy in Python. The YAML condition `variables.get('pending_memory_review')` evaluates string \"false\" as True. Fix: either make set_variable coerce \"true\"/\"false\" strings to booleans, or change the gate condition to check `variables.get('pending_memory_review') == True` or `is True`. Also, on_after_tool resets stop_attempts to 0 on every tool call, which means the 3-strike escape hatch can never trigger if the agent keeps calling tools to try to clear the variable.", "type": "pattern", "importance": 0.9, "tags": ["bug", "memory-system", "workflow-engine", "set_variable"], "created_at": "2026-02-11T15:09:03.518439+00:00", "updated_at": "2026-02-11T15:09:03.518439+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-f7fa2e99", "content": "Architecture decision: For web UI chat sessions that lack SessionStart hooks, use a 'headless-lifecycle.yaml' workflow (separate from session-lifecycle.yaml) that moves all session_start initialization into on_before_agent with a _session_initialized guard variable. Backend (ChatMixin) handles session DB registration, lifecycle activation, and /clear. SDK hooks bridge to the workflow engine via callbacks. Plan at docs/plans/web-chat-lifecycle.md.", "type": "decision", "importance": 0.9, "tags": ["architecture", "web-chat", "lifecycle", "headless"], "created_at": "2026-02-10T03:17:03.573659+00:00", "updated_at": "2026-02-10T03:17:03.573659+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-fb475c85", "content": "The Claude Agent SDK (claude_agent_sdk) supports these Python hook types: UserPromptSubmit, PreToolUse, PostToolUse, PreCompact (with trigger: 'manual' | 'auto'), Stop, SubagentStop. It explicitly does NOT support SessionStart, SessionEnd, or Notification hooks. Hooks are registered via ClaudeAgentOptions(hooks={'PreCompact': [HookMatcher(matcher=None, hooks=[callback])]}).", "type": "fact", "importance": 0.9, "tags": ["claude-sdk", "hooks", "web-chat"], "created_at": "2026-02-10T03:16:56.088116+00:00", "updated_at": "2026-02-10T03:16:56.088116+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-bc234065", "content": "Web UI useFiles.ts had getBaseUrl() returning http://hostname:60887 for HTTP connections, creating cross-origin requests that bypass the Vite proxy. This caused 'TypeError: Failed to fetch' when opening multiple files. Fix: always return '' (relative URLs) since Vite proxy is configured for /api→localhost:60887 in dev, and production serves both static+API on same origin. Multiple useCallback hooks (openFile, saveFile, expandProject, expandDir) had stale closure bugs from depending on openFiles/expandedDirs state. Fix: use useRef to track latest state and remove state from dependency arrays.", "type": "debugging", "importance": 0.9, "tags": ["web-ui", "useFiles", "stale-closure", "cors", "debugging"], "created_at": "2026-02-10T02:58:12.398418+00:00", "updated_at": "2026-02-12T18:38:27.986719+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-cbd103cd", "content": "When updating gobby's version number, update it in TWO places: pyproject.toml and src/gobby/__init__.py", "type": "pattern", "importance": 0.9, "tags": "release,versioning,development", "created_at": "2026-02-05T00:41:11.939039+00:00", "updated_at": "2026-02-05T00:41:11.939039+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-bf7a7539", "content": "The gobby project has a pre-merge-commit hook that blocks automatic merge commits. When merging branches, if the hook fails, manually commit the merge using 'git commit' rather than relying on automatic merge commit creation.", "type": "pattern", "importance": 0.9, "tags": ["git", "merge", "pre-commit-hook", "gobby"], "created_at": "2026-01-26T22:59:23.544337+00:00", "updated_at": "2026-01-26T22:59:23.544337+00:00", "source": "session", "source_id": "b422c481-ba1d-44da-8912-666de487efbf"}
{"id": "mm-2e8319e2", "content": "In gobby's conductor module, pricing.py and token_tracker.py are intentionally placed in conductor/ (not a separate metrics/ module) because they are active control plane components that drive orchestration decisions, not passive observability. SessionTokenTracker.can_spawn_agent() gates agent spawning based on budget, and ConductorLoop uses BudgetChecker to throttle the loop when budget is exceeded.", "type": "fact", "importance": 0.9, "tags": ["architecture", "conductor", "budget-management", "cost-control"], "created_at": "2026-01-26T21:16:57.260247+00:00", "updated_at": "2026-01-26T21:16:57.260247+00:00", "source": "session", "source_id": "9ef8d770-7c10-4f8e-800a-a7c749644689"}
{"id": "mm-79c16332", "content": "Step workflows in gobby require explicit activation via activate_workflow() call before steps execute. The on_enter hook only runs after activation, not immediately when a child agent is spawned. Parent workflows (like meeseeks-box) must include activation instructions in the spawn prompt.", "type": "pattern", "importance": 0.9, "tags": ["workflows", "meeseeks", "lifecycle", "parent-child"], "created_at": "2026-01-26T14:25:46.470795+00:00", "updated_at": "2026-01-26T14:25:46.470795+00:00", "source": "session", "source_id": "4cb1f535-45d0-476c-92e1-5c11a06e1ef2"}
{"id": "mm-30645c7e", "content": "Gobby uses ~/.gobby/ directory for its database (gobby-hub.db), config (config.yaml), and other runtime files. When running different versions of gobby, they share this directory and database, which can cause schema compatibility issues. Use GOBBY_HOME environment variable to isolate different gobby instances if needed.", "type": "fact", "importance": 0.9, "tags": ["gobby", "database", "configuration", "environment"], "created_at": "2026-01-25T23:52:00.971538+00:00", "updated_at": "2026-01-25T23:52:00.971538+00:00", "source": "session", "source_id": "2ceaa340-cf01-4208-80b8-dcc482c3992c"}
{"id": "mm-2bb6bfa4", "content": "LocalTaskManager.get_task() in src/gobby/storage/tasks/_manager.py accepts multiple task ID formats (UUID, #N, N notation) and resolves them internally, but direct comparisons between task.id (UUID) and claimed_task_id values fail if claimed_task_id stores non-UUID formats.", "type": "fact", "importance": 0.9, "tags": ["gobby", "task-management", "id-formats", "bug-pattern"], "created_at": "2026-01-25T18:32:33.161333+00:00", "updated_at": "2026-01-25T18:32:33.161333+00:00", "source": "session", "source_id": "3fe55f9e-069d-470f-ab2f-03ceaf53a6b0"}
{"id": "mm-1a26cb0a", "content": "Task ID comparison bugs exist at _lifecycle.py:199 (claimed_task_id == resolved_id) and task_enforcement_actions.py:963 (t.id == claimed_task_id). These fail when claimed_task_id contains refs like '#6066' instead of UUIDs. Fix: ensure claimed_task_id always stores resolved UUIDs at storage time.", "type": "context", "importance": 0.9, "tags": ["gobby", "bug-location", "task-ids", "comparison"], "created_at": "2026-01-25T18:19:24.504439+00:00", "updated_at": "2026-01-25T18:19:24.504439+00:00", "source": "session", "source_id": "3fe55f9e-069d-470f-ab2f-03ceaf53a6b0"}
{"id": "mm-9a411c25", "content": "The gobby project uses SQLite with custom datetime adapters. The `_adapt_datetime` function in `database.py` (line 24) uses `isoformat(\" \")` which produces space-separated timestamps like \"2026-01-25 01:43:54\" instead of ISO 8601 standard \"2026-01-25T01:43:54\". This non-standard format can cause timestamp normalization issues in exported JSONL files.", "type": "fact", "importance": 0.9, "tags": ["database", "datetime", "sqlite", "bug-source"], "created_at": "2026-01-25T03:59:31.178992+00:00", "updated_at": "2026-01-25T03:59:31.178992+00:00", "source": "session", "source_id": "8dfb36ae-572d-4a12-a667-0e710b658a2d"}
{"id": "mm-8cd3d655", "content": "Gobby's bind_host configuration is currently manual—no automatic Tailscale detection exists. The bind_host setting is in src/gobby/config/app.py (default port 60887). When Tailscale is properly configured, users must manually set bind_host to 0.0.0.0 to serve across the network; otherwise it defaults to localhost.", "type": "fact", "importance": 0.85, "tags": ["configuration", "tailscale", "networking", "bind_host"], "created_at": "2026-02-12T22:02:45.034992+00:00", "updated_at": "2026-02-12T22:02:45.034992+00:00", "source": "session", "source_id": "432c9580-9d9f-46ca-9c22-ad02bfc2d171"}
{"id": "mm-c2fff3b1", "content": "Daemon restart required after skill code changes to reload skill definitions. Use 'uv run gobby restart' to pick up newly added or modified skills (session discovered 32 skills loaded after restart).", "type": "pattern", "importance": 0.85, "tags": ["development-workflow", "daemon", "skills"], "created_at": "2026-02-12T19:19:28.573782+00:00", "updated_at": "2026-02-12T19:19:28.573782+00:00", "source": "session", "source_id": "60cfb08d-8b7d-4c3b-8d91-b24dae2cbabd"}
{"id": "mm-85f6598e", "content": "Mem0 API Dockerfile pinned to version 0.1.115 but compose uses `latest` tag — version mismatch causes container unhealthy status. Source and installed Dockerfiles are independent copies; fixes must be applied to both locations.", "type": "fact", "importance": 0.85, "tags": ["mem0", "docker", "version-mismatch", "deployment"], "created_at": "2026-02-12T18:51:06.892724+00:00", "updated_at": "2026-02-12T18:51:06.892724+00:00", "source": "session", "source_id": "4f4bc972-1c3c-41ef-b0d1-20c8b4730655"}
{"id": "mm-f81c90dc", "content": "A pre-tool-use hook error in the file path '.claude/hooks/hook_dispatcher.py' caused a tool to be blocked, and feedback suggests not stopping despite the error.", "type": "fact", "importance": 0.85, "tags": ["hook error", "tool blockage", "debugging"], "created_at": "2026-02-12T18:42:49.349329+00:00", "updated_at": "2026-02-12T18:42:49.349329+00:00", "source": "session", "source_id": "a8cbfde2-f52a-44bb-9dbf-23cdb75b7401"}
{"id": "mm-1df90456", "content": "The task of fixing mypy errors included ensuring there are no issues remaining in the code. During work on 'AgentDefinitionsPage.tsx', an Edit button was added next to the detail view, and the build process highlighted some chunks larger than 500 kB after minification, suggesting the need for dynamic imports or code splitting.", "type": "fact", "importance": 0.85, "tags": ["build", "performance", "minification"], "created_at": "2026-02-12T18:16:17.580614+00:00", "updated_at": "2026-02-12T18:16:17.580614+00:00", "source": "session", "source_id": "50115209-7ed5-4649-9eaf-fba48a0473c4"}
{"id": "mm-96dde21c", "content": "Timezone gotcha in session activity stats: When querying commits/tasks within a session date range, ensure timezone-aware datetime comparisons. The session created_at is stored in UTC, but filtering may use local time, causing off-by-one-day issues if not careful with timezone normalization.", "type": "fact", "importance": 0.85, "tags": ["gobby", "session-stats", "datetime", "timezone", "debugging"], "created_at": "2026-02-12T17:34:07.463660+00:00", "updated_at": "2026-02-12T17:34:07.463660+00:00", "source": "session", "source_id": "5d62aa66-df84-418d-890c-d4d71f58a3ff"}
{"id": "mm-25caa9ce", "content": "The mem0 backend was removed from the memory setup, leaving only the 'local' (SQLite) backend available.", "type": "fact", "importance": 0.85, "tags": ["memory_config", "backend", "SQLite"], "created_at": "2026-02-12T05:45:06.789495+00:00", "updated_at": "2026-02-12T05:45:06.789495+00:00", "source": "session", "source_id": "687611cf-90fa-4295-ab3c-4d37d209ff2e"}
{"id": "mm-5cd62661", "content": "During the session, it was determined that `DaemonConfig` does not have `frozen=True`, which was crucial for resolving an issue related to Web UI configuration.", "type": "fact", "importance": 0.85, "tags": ["debugging", "configuration"], "created_at": "2026-02-12T05:41:59.093088+00:00", "updated_at": "2026-02-12T05:41:59.093088+00:00", "source": "session", "source_id": "99ebf42b-ba46-43b9-8b06-426dd4af0ffd"}
{"id": "mm-e82dd91a", "content": "The recent edit in `lifecycle_evaluator.py` involved adding `observer_engine` as a keyword argument, which caused unexpected test failures due to previously unrecognized parameters.", "type": "fact", "importance": 0.85, "tags": ["parameter quirk", "test failure", "observer_engine"], "created_at": "2026-02-12T05:14:32.714896+00:00", "updated_at": "2026-02-12T05:14:32.714896+00:00", "source": "session", "source_id": "8264345e-68a1-4f70-bbea-e4d703df9389"}
{"id": "mm-febb9866", "content": "Bug #8055: The auto-task workflow in the 'gobby' project ignores 'assigned_task_id' and requires fixing of the 'session_task' variable. The issue might involve the workflow not accepting 'N' or '#N' for 'session_id' in the 'mcp' call.", "type": "fact", "importance": 0.85, "tags": ["bug", "workflow", "session_task", "assigned_task_id"], "created_at": "2026-02-12T05:03:06.204699+00:00", "updated_at": "2026-02-12T05:03:06.204699+00:00", "source": "session", "source_id": "7e334f64-c43a-46fe-8f4d-29b72e1c6526"}
{"id": "mm-35665903", "content": "The `memories` table does not have a session ID column, which may cause confusion or errors when attempting to reference sessions.", "type": "fact", "importance": 0.85, "tags": ["database", "schema", "memories"], "created_at": "2026-02-12T04:58:12.502359+00:00", "updated_at": "2026-02-12T04:58:12.502359+00:00", "source": "session", "source_id": "971fbce6-9aeb-4001-9097-8d3b11e63b18"}
{"id": "mm-d3b61f6d", "content": "The task of fixing mypy errors included ensuring that there are no issues remaining in the code after updates.", "type": "context", "importance": 0.85, "tags": ["mypy", "linting", "issue resolution"], "created_at": "2026-02-12T03:04:39.281641+00:00", "updated_at": "2026-02-12T03:04:39.281641+00:00", "source": "session", "source_id": "669b1ae9-d975-4308-a38d-267e7ca871e4"}
{"id": "mm-adfad928", "content": "The file `factory.py` had no unstaged or staged changes during the session because the changes had already been committed. This discovery clarified why modifications were not appearing as expected.", "type": "fact", "importance": 0.85, "tags": ["git", "commits", "file changes"], "created_at": "2026-02-12T02:04:08.171384+00:00", "updated_at": "2026-02-12T02:04:08.171384+00:00", "source": "session", "source_id": "4c1d8ccb-7f94-49ac-8922-587d0f5baf04"}
{"id": "mm-a6a0b28a", "content": "There was an error when attempting to open a directory 'web/web/tests/' indicating it does not exist. This caused a fatal pathspec error related to 'web/tests/terminal-color.' The solution involved using a full path, indicating possible issues with current working directory assumptions.", "type": "fact", "importance": 0.85, "tags": ["debugging", "directory-structure", "filesystem"], "created_at": "2026-02-12T01:03:49.236451+00:00", "updated_at": "2026-02-12T01:03:49.236451+00:00", "source": "session", "source_id": "7ed97f8f-a6c1-4ee7-84d4-216f0f91b733"}
{"id": "mm-de85ebb0", "content": "A standard sidebar width is specified as 260px, and this template is applied in updating 'nifty-snacking-waterfall.md'.", "type": "pattern", "importance": 0.85, "tags": ["UI", "styleguide", "sidebar"], "created_at": "2026-02-12T00:03:26.301243+00:00", "updated_at": "2026-02-12T00:03:26.301243+00:00", "source": "session", "source_id": "48603b3e-2995-4a3c-8cc1-4cabcc41a55b"}
{"id": "mm-d1e3d60f", "content": "The current migration version is 90, and a one-off SQL query for 'A1' is now included in the updated plan file 'nifty-snacking-waterfall.md'.", "type": "fact", "importance": 0.85, "tags": ["migration", "SQL", "plan"], "created_at": "2026-02-12T00:03:14.861071+00:00", "updated_at": "2026-02-12T00:03:14.861071+00:00", "source": "session", "source_id": "48603b3e-2995-4a3c-8cc1-4cabcc41a55b"}
{"id": "mm-01fbe3e5", "content": "The session established that all 6 batch agents are running in parallel and actively working, achieving 100% test coverage on four source files.", "type": "context", "importance": 0.85, "tags": ["test coverage", "batch agents"], "created_at": "2026-02-11T22:27:44.352369+00:00", "updated_at": "2026-02-11T22:27:44.352369+00:00", "source": "session", "source_id": "a57eb6c0-deae-4349-8311-b79d4667387b"}
{"id": "mm-ad886cfc", "content": "The project currently has 78.67% test coverage and needs an additional 8% to reach the desired 82% coverage target.", "type": "fact", "importance": 0.85, "tags": ["coverage", "metrics"], "created_at": "2026-02-11T22:08:04.131483+00:00", "updated_at": "2026-02-11T22:08:04.131483+00:00", "source": "session", "source_id": "807bb581-68c4-4b86-ad3d-71fc16492214"}
{"id": "mm-0b993eae", "content": "The `message_count` column is not present in the schema and must be computed, likely derived from the `message_map` variable in the code.", "type": "fact", "importance": 0.85, "tags": ["schema", "message_count", "computed"], "created_at": "2026-02-11T22:02:58.917620+00:00", "updated_at": "2026-02-11T22:02:58.917620+00:00", "source": "session", "source_id": "b3d9d76c-7bc6-459e-9713-e854979b9a29"}
{"id": "mm-9930a242", "content": "ForceGraph3D (react-force-graph-3d) destroys custom nodeThreeObject instances (SpriteText labels) on parent re-renders. CONFIRMED: even with ALL ForceGraph3D props stable (memoized callbacks, constant values, no nodePositionUpdate), labels still disappear when parent component re-renders due to state change. The react-kapsule wrapper appears to re-process nodes on ANY re-render, not just prop changes. Attempted fixes that FAILED: (1) Removing nodePositionUpdate + memoizing nodeLabel + constant linkDirectionalParticles — still broke. (2) Using animateIdleRef to avoid prop changes — still broke. (3) rAF loop for animation outside React — animation itself works but labels still lost. The issue is fundamental to how react-force-graph-3d/react-kapsule handles re-renders. Next approach to try: React.memo() wrapper on ForceGraph3D, or isolating it in a child component that never re-renders (no state, only refs).", "type": "debugging", "importance": 0.85, "tags": ["react-force-graph-3d", "three.js", "ForceGraph3D", "SpriteText", "react-kapsule", "animation"], "created_at": "2026-02-11T21:49:49.461832+00:00", "updated_at": "2026-02-11T22:07:21.059640+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-69d4c1d5", "content": "The session highlights a bug related to toggling animations in the UI: **Before toggle** the 365 Knowledge Graph nodes are clearly visible, but **After toggle** an animation causes flickering, making it hard to read labels.", "type": "fact", "importance": 0.85, "tags": ["bug", "ui", "knowledge graph", "animation"], "created_at": "2026-02-11T21:15:28.877572+00:00", "updated_at": "2026-02-11T21:15:28.877572+00:00", "source": "session", "source_id": "a3fe98a6-4c68-48d4-b67c-e27bd4103b92"}
{"id": "mm-68041626", "content": "The format conventions for plan documents include specific heading styles and sections, as exemplified by the 'Auto-Detect CLIs, Auth Modes, and Models on Daemon Startup' section.", "type": "fact", "importance": 0.85, "tags": ["format", "conventions", "plan documents"], "created_at": "2026-02-11T21:13:17.062511+00:00", "updated_at": "2026-02-11T21:13:17.062511+00:00", "source": "session", "source_id": "1e52524f-f0e8-49f3-8245-0ee6c0f6a823"}
{"id": "mm-59745a69", "content": "There was a UNIQUE constraint error when attempting to execute an expansion, which indicates that all 17 dependencies were already wired. This suggests that the expansion logic correctly ensures all dependencies are set up, and re-running it will not duplicate tasks.", "type": "fact", "importance": 0.85, "tags": ["debugging", "dependency management", "error handling"], "created_at": "2026-02-11T19:30:03.360621+00:00", "updated_at": "2026-02-11T19:30:03.360621+00:00", "source": "session", "source_id": "d0446fa0-f37c-4bad-b269-1bd5ed7d73a1"}
{"id": "mm-206b0a84", "content": "The `de_escalate` function is referenced in multiple locations within the codebase, such as in `task_validation.py:452`, and is implemented in both the MCP tool and as an HTTP route.", "type": "fact", "importance": 0.85, "tags": ["function usage", "code references"], "created_at": "2026-02-11T19:24:05.600577+00:00", "updated_at": "2026-02-11T19:24:05.600577+00:00", "source": "session", "source_id": "8e0e0642-0012-43cb-b811-eddc78893202"}
{"id": "mm-8157dc3e", "content": "A pre-tool-use hook error in the file path '.claude/hooks/hook_dispatcher.py' caused a tool to be blocked, and feedback suggests not stopping despite the error.", "type": "fact", "importance": 0.85, "tags": ["hook error", "tool blockage", "debugging"], "created_at": "2026-02-11T15:47:22.636635+00:00", "updated_at": "2026-02-11T15:47:22.636635+00:00", "source": "session", "source_id": "a8cbfde2-f52a-44bb-9dbf-23cdb75b7401"}
{"id": "mm-74ae00c8", "content": "A pre-tool-use hook error in the file path '.claude/hooks/hook_dispatcher.py' caused a tool to be blocked, and feedback suggests not stopping despite the error.", "type": "fact", "importance": 0.85, "tags": ["hook error", "tool blockage", "debugging"], "created_at": "2026-02-11T15:21:29.992628+00:00", "updated_at": "2026-02-11T15:21:29.992628+00:00", "source": "session", "source_id": "a8cbfde2-f52a-44bb-9dbf-23cdb75b7401"}
{"id": "mm-f51d4e1a", "content": "Self-hosted mem0 Docker API uses different paths than the hosted platform: /memories and /search (no /v1/ prefix, no trailing slashes). The Mem0Client auto-detects by checking if 'api.mem0.ai' is in the base_url. Response format uses 'memory' field instead of 'content'. The mem0 Docker instance runs on port 8888 with postgres on 8432 and neo4j on 8474/8687.", "type": "fact", "importance": 0.85, "tags": ["mem0", "docker", "api-paths", "self-hosted"], "created_at": "2026-02-11T02:02:10.649543+00:00", "updated_at": "2026-02-11T02:02:10.649543+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-2418f3f8", "content": "The Claude Agent SDK has resume and fork_session options: ClaudeAgentOptions(resume='<session-uuid>', fork_session=False). The SDK wraps the Claude CLI binary and passes --resume <session_id> to it. Claude Code manages JSONL transcripts at ~/.claude/sessions/<session-id>/. Web chat sessions DO have JSONL transcripts because the underlying CLI writes them via --output-format stream-json.", "type": "fact", "importance": 0.85, "tags": ["claude-sdk", "sessions", "transcripts", "web-chat"], "created_at": "2026-02-10T03:17:00.347196+00:00", "updated_at": "2026-02-10T03:17:00.347196+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-6b6f9fe6", "content": "InternalToolRegistry schema generation still produces type: 'string' for all parameters in MCP tool schemas (e.g., search_memories limit: int shows as type: string). The #7418 fix for get_tools_json_schema() with typing.get_type_hints() may not cover all code paths. Passing limit as string '5' causes 'slice indices must be integers' error at runtime.", "type": "fact", "importance": 0.85, "tags": "bug,schema,mcp-proxy,InternalToolRegistry", "created_at": "2026-02-10T02:42:46.325325+00:00", "updated_at": "2026-02-10T02:42:46.325325+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-fda429ea", "content": "gobby's spawn_agent tool uses a preflight capture pattern via prepare_gemini_spawn_with_preflight to obtain a Gemini session_id before launching the terminal. The preflight succeeds (capturing session_id in format that becomes run_id like 'gemini-{first8chars}'), but subsequent terminal spawn via 'open -na Ghostty.app' can fail silently—the macOS 'open' utility returns success even if Ghostty fails to execute the command afterward, making shell escaping of long prompts a potential failure point.", "type": "context", "importance": 0.85, "tags": ["gobby", "spawn_agent", "gemini", "terminal_spawn", "preflight", "failure_mode"], "created_at": "2026-01-28T20:27:23.834828+00:00", "updated_at": "2026-01-28T20:27:23.834828+00:00", "source": "session", "source_id": "d347d68e-869d-4a6e-a8d5-8fe855bba25e"}
{"id": "mm-3dcf766c", "content": "Prompt file creation in prompt_manager.py requires: (1) sanitize session_id to prevent path traversal by stripping separators/disallowed chars or using uuid4, (2) use thread-safe lock (_atexit_lock) around _atexit_registered check to prevent race conditions in atexit registration, (3) store safe path in _prompt_files_to_cleanup for cleanup on exit.", "type": "pattern", "importance": 0.85, "tags": ["security", "path-traversal", "thread-safety", "prompt-manager"], "created_at": "2026-01-27T22:52:38.926303+00:00", "updated_at": "2026-01-27T22:52:38.926303+00:00", "source": "session", "source_id": "935114fe-ccaa-4dfc-8f95-99956c976c4f"}
{"id": "mm-d2d969c7", "content": "Task lifecycle tools in _lifecycle.py must return success: False on errors so that _process_tool_proxy_result can correctly identify and handle task failures. Returning success: true with an error is a bug that masks failures.", "type": "fact", "importance": 0.85, "tags": ["architecture", "error-handling", "_lifecycle.py", "_process_tool_proxy_result"], "created_at": "2026-01-26T22:56:14.015774+00:00", "updated_at": "2026-01-26T22:56:14.015774+00:00", "source": "session", "source_id": "b422c481-ba1d-44da-8912-666de487efbf"}
{"id": "mm-874484a3", "content": "Terminal mode spawning (mode='terminal') should not use -p flag to allow multi-turn interaction. The -p flag causes single-turn exit and is only appropriate for headless spawning. This was a critical fix in spawn.py.", "type": "pattern", "importance": 0.85, "tags": ["spawn", "terminal-mode", "claude-integration"], "created_at": "2026-01-26T14:25:01.562910+00:00", "updated_at": "2026-01-26T14:25:01.562910+00:00", "source": "session", "source_id": "4cb1f535-45d0-476c-92e1-5c11a06e1ef2"}
{"id": "mm-099c9ea0", "content": "In gobby's detection_helpers.py, when handling close_task in the AFTER_TOOL hook (lines 67-81), the function should NOT clear task_claimed if tool_output is empty, since it cannot verify whether the close actually succeeded. The MCP proxy's close_task handles clearing task_claimed for genuine successes.", "type": "pattern", "importance": 0.85, "tags": ["detection_helpers", "close_task", "task_claimed", "fix-strategy"], "created_at": "2026-01-25T17:14:28.200002+00:00", "updated_at": "2026-01-25T17:14:28.200002+00:00", "source": "session", "source_id": "b08118fe-cfa2-4c04-b92a-d381c05e7eda"}
{"id": "mm-7b530aea", "content": "The gobby MCP proxy's close_task function has validation checks (validate_commit_requirements) that return errors BEFORE the code that clears task_claimed state (lines 192-207). So the proxy itself doesn't clear task_claimed on validation failures - only on actual successful closes.", "type": "fact", "importance": 0.85, "tags": ["_lifecycle.py", "close_task", "state-management", "validation-flow"], "created_at": "2026-01-25T17:14:28.199456+00:00", "updated_at": "2026-01-25T17:14:28.199456+00:00", "source": "session", "source_id": "b08118fe-cfa2-4c04-b92a-d381c05e7eda"}
{"id": "mm-51f265f6", "content": "The gobby expansion workflow stores expansion_context in task metadata and the get_expansion_spec tool tracks pending status. After execute_expansion completes, the spec's pending flag becomes false and all dependencies are wired - attempting to wire them again will trigger UNIQUE constraint violations, which is expected behavior indicating successful idempotent completion.", "type": "fact", "importance": 0.82, "tags": ["gobby", "expansion-workflow", "state-management", "database-schema"], "created_at": "2026-02-12T19:56:33.248968+00:00", "updated_at": "2026-02-12T19:56:33.248968+00:00", "source": "session", "source_id": "d0446fa0-f37c-4bad-b269-1bd5ed7d73a1"}
{"id": "mm-9b8abaf9", "content": "Gobby config system uses ConfigStore (typed as Any | None) in SkillsRegistry. Config loading happens in two phases: Phase 1 loads from file/CLI, Phase 2 reloads from DB (secrets > env vars). The load_config() function is in the config module and handles file path, CLI overrides, and database reload logic.", "type": "context", "importance": 0.8, "tags": ["config", "architecture", "SkillsRegistry"], "created_at": "2026-02-13T01:22:21.981464+00:00", "updated_at": "2026-02-13T01:22:21.981464+00:00", "source": "session", "source_id": "a5e24b58-a6c5-4da0-b65b-b05ff10f1c38"}
{"id": "mm-34bd910d", "content": "runner.py Phase 2 config reload bug: The second load_config() call (with config_store) didn't pass config_file, so when the DB config_store was empty (fresh installs, e2e tests), DaemonConfig(**{}) returned all defaults (daemon_port=60887, default DB path). Fix: pass self._config_file to both load_config calls, and in load_config fall back to YAML when config_store is empty.", "type": "debugging", "importance": 0.8, "tags": ["runner", "config", "e2e-tests", "root-cause"], "created_at": "2026-02-13T00:37:53.196815+00:00", "updated_at": "2026-02-13T00:37:53.196815+00:00", "source": "mcp_tool", "source_id": "3459526d-63d7-414f-9a94-66cf359ad6a9"}
{"id": "mm-58c57291", "content": "Gobby has a bind_host configuration (defaults to localhost) that can be set to 0.0.0.0 for Tailscale remote access. Currently, detection/automation of Tailscale presence is NOT implemented—it's purely manual configuration via bind_host setting in src/gobby/config/app.py.", "type": "fact", "importance": 0.8, "tags": ["tailscale", "network-config", "bind_host", "feature-gap"], "created_at": "2026-02-12T21:14:02.310825+00:00", "updated_at": "2026-02-12T21:14:02.310825+00:00", "source": "session", "source_id": "432c9580-9d9f-46ca-9c22-ad02bfc2d171"}
{"id": "mm-f87ed79f", "content": "Gobby daemon default bind_host is 'localhost' (not '0.0.0.0'), configured in src/gobby/config/app.py line 221-222 with default port 60887. This restricts daemon to local connections only unless explicitly changed.", "type": "fact", "importance": 0.8, "tags": ["gobby", "daemon", "configuration", "networking"], "created_at": "2026-02-12T20:14:33.830536+00:00", "updated_at": "2026-02-12T20:14:33.830536+00:00", "source": "session", "source_id": "aed5d772-3baa-4249-b0f2-cd721b653301"}
{"id": "mm-9725cf67", "content": "The gobby project has a hook_dispatcher system at .claude/hooks/hook_dispatcher.py that validates tool calls. PreToolUse hooks can fail with constraint violations (e.g., UNIQUE constraint on task_dependencies) - these failures are recoverable and don't indicate actual API errors, just that operations already succeeded in previous attempts.", "type": "pattern", "importance": 0.8, "tags": ["gobby", "hook-system", "error-handling", "idempotency"], "created_at": "2026-02-12T19:56:16.389478+00:00", "updated_at": "2026-02-12T19:56:16.389478+00:00", "source": "session", "source_id": "d0446fa0-f37c-4bad-b269-1bd5ed7d73a1"}
{"id": "mm-06218e98", "content": "Config Resolution (DB-First, Two-Phase): Config is DB-first via config_store table (migration 98). YAML is import/export only. Phase 1 (runner.py:61): load_config() from yaml bootstraps database_path only. Phase 2 (runner.py:~95): After DB init, _maybe_import_yaml_to_db() one-time migrates yaml to DB, then load_config(config_store=...) loads from DB. Resolution: DB config_store > Pydantic defaults. $secret: and ${VAR} patterns resolved at load time via _resolve_config_values(). One-time import tracked by _meta.yaml_imported key. ConfigStore at src/gobby/storage/config_store.py with flatten_config()/unflatten_config(). deep_merge() in config/app.py. REST: /api/config/template replaced /api/config/yaml; export uses config_store field. LiteLLMProvider unconditionally sets env vars from config.", "type": "pattern", "importance": 0.8, "tags": ["config", "database", "architecture"], "created_at": "2026-02-12T19:37:13.391012+00:00", "updated_at": "2026-02-12T19:37:13.391012+00:00", "source": "mcp_tool", "source_id": "4552a4b4-25cd-4850-b649-29cff6320a00"}
{"id": "mm-134fa8ab", "content": "Skill Routing (/gobby commands): Claude Code's Skill tool only knows native skills (.claude/commands/). Gobby skills are routed via hook interception in _agent.py, NOT via the Skill tool. /gobby expand routing: _intercept_skill_command() in src/gobby/hooks/event_handlers/_agent.py matches /gobby commands and injects <skill-context> blocks via hooks. Supports both `/gobby:expand` (colon) and `/gobby expand` (space) syntax.", "type": "pattern", "importance": 0.8, "tags": ["skills", "routing", "hooks", "commands"], "created_at": "2026-02-12T19:35:33.231396+00:00", "updated_at": "2026-02-12T19:35:33.231396+00:00", "source": "mcp_tool", "source_id": "4552a4b4-25cd-4850-b649-29cff6320a00"}
{"id": "mm-d3ef80b8", "content": "Skill Injection Architecture: SkillInjector in src/gobby/skills/injector.py handles context-aware skill selection. AgentContext.from_session() derives agent_type from depth + workflow name. Skills have metadata.gobby in SKILL.md frontmatter with audience/depth/format_overrides. `filter: context_aware` in lifecycle YAMLs routes through SkillInjector. SkillProfile allows per-agent include/exclude/format overrides via _skill_profile variable. Workflow state is one per session (shared by lifecycle + step workflows). ParsedSkill.always_apply field (not is_always_apply() method) used for legacy fallback.", "type": "pattern", "importance": 0.8, "tags": ["skills", "injection", "architecture", "workflows"], "created_at": "2026-02-12T19:35:00.893970+00:00", "updated_at": "2026-02-12T19:35:00.893970+00:00", "source": "mcp_tool", "source_id": "4552a4b4-25cd-4850-b649-29cff6320a00"}
{"id": "mm-aa0e0be3", "content": "Session Matching for Spawned Agents: Spawned agents find their pre-created sessions via GOBBY_SESSION_ID env var. Flow: 1) Parent pre-creates child session with known ID. 2) Env vars set during terminal spawn include GOBBY_SESSION_ID. 3) Hook dispatcher captures env vars in terminal_context. 4) Daemon matches session via gobby_session_id in terminal_context.", "type": "pattern", "importance": 0.8, "tags": ["sessions", "agents", "spawning", "env-vars"], "created_at": "2026-02-12T19:34:37.124150+00:00", "updated_at": "2026-02-12T19:34:37.124150+00:00", "source": "mcp_tool", "source_id": "4552a4b4-25cd-4850-b649-29cff6320a00"}
{"id": "mm-6001a855", "content": "ParsedSkill uses `.always_apply` field (not `is_always_apply()` method) for legacy fallback when determining if a skill should always be applied. This is the correct property to check in skill routing logic.", "type": "fact", "importance": 0.8, "tags": ["skill-routing", "parsing", "legacy-behavior"], "created_at": "2026-02-12T19:25:27.311708+00:00", "updated_at": "2026-02-12T19:25:27.311708+00:00", "source": "session", "source_id": "60cfb08d-8b7d-4c3b-8d91-b24dae2cbabd"}
{"id": "mm-c3385832", "content": "ParsedSkill.always_apply field (not is_always_apply() method) is used for legacy fallback when checking if skills should always be applied. This is the actual field used in skill routing logic, not the method.", "type": "fact", "importance": 0.8, "tags": ["skill-routing", "skills", "legacy-behavior"], "created_at": "2026-02-12T19:19:19.897227+00:00", "updated_at": "2026-02-12T19:19:19.897227+00:00", "source": "session", "source_id": "60cfb08d-8b7d-4c3b-8d91-b24dae2cbabd"}
{"id": "mm-16402158", "content": "Hook dispatcher errors occur when closing tasks via mcp__gobby__call_tool if changes haven't been committed first. Always run `git commit` before calling close_task to avoid 'PreToolUse:mcp__gobby__call_tool hook error' failures.", "type": "pattern", "importance": 0.8, "tags": ["gobby-hooks", "task-management", "error-handling"], "created_at": "2026-02-12T19:07:22.001206+00:00", "updated_at": "2026-02-12T19:07:22.001206+00:00", "source": "session", "source_id": "fdbe93cd-b8d2-4a91-a9bb-596077e30e6d"}
{"id": "mm-36f0976b", "content": "tmux `set-titles` option must be enabled in config for window rename propagation to work. The setting affects how session titles propagate when spawning agents. Without this enabled, terminal window titles won't update properly in tmux.", "type": "fact", "importance": 0.8, "tags": ["tmux", "configuration", "window-management", "gobby-core"], "created_at": "2026-02-12T19:07:03.888415+00:00", "updated_at": "2026-02-12T19:07:03.888415+00:00", "source": "session", "source_id": "fdbe93cd-b8d2-4a91-a9bb-596077e30e6d"}
{"id": "mm-932ea0d8", "content": "DANGER: Do NOT write OSC 2 escape sequences directly to the tmux client TTY (/dev/ttysXXX). This injects bytes into tmux's input stream and can kill the terminal window. Instead, use `tmux set-option -g set-titles on` to propagate window names to the outer terminal emulator.", "type": "pattern", "importance": 0.8, "tags": ["terminal-spawning", "escape-sequences", "tmux", "macos"], "created_at": "2026-02-12T18:53:59.905710+00:00", "updated_at": "2026-02-12T19:01:04.016868+00:00", "source": "session", "source_id": "fdbe93cd-b8d2-4a91-a9bb-596077e30e6d"}
{"id": "mm-7b767da0", "content": "tmux `set-titles` is disabled globally in the environment (tmux 3.6a shows 'set-titles off'). This prevents automatic window title updates via escape sequences. To enable dynamic titles, need to explicitly set `set-titles on` in tmux config or per-session.", "type": "fact", "importance": 0.8, "tags": ["tmux", "configuration", "terminal-spawning", "gobby"], "created_at": "2026-02-12T18:53:47.410929+00:00", "updated_at": "2026-02-12T18:53:47.410929+00:00", "source": "session", "source_id": "fdbe93cd-b8d2-4a91-a9bb-596077e30e6d"}
{"id": "mm-40f83732", "content": "When hook dispatcher blocks a tool (via `Do not stop` feedback), Claude Code silently suppresses subsequent Read/Write tool calls with `<tool_use_error>Sibling tool call errored</tool_use_error>`. Workaround: abandon the blocked operation and start fresh, or use Bash as an alternative when Read/Write are blocked.", "type": "pattern", "importance": 0.8, "tags": ["claude-code", "hooks", "tool-blocking", "error-handling"], "created_at": "2026-02-12T18:47:51.546200+00:00", "updated_at": "2026-02-12T18:47:51.546200+00:00", "source": "session", "source_id": "4f4bc972-1c3c-41ef-b0d1-20c8b4730655"}
{"id": "mm-b35d7320", "content": "The file src/gobby/mcp_proxy/tools/cron.py requires adding `Literal` to the typing import.", "type": "fact", "importance": 0.8, "tags": ["imports", "typing", "cron.py"], "created_at": "2026-02-12T18:42:49.366546+00:00", "updated_at": "2026-02-12T18:42:49.366546+00:00", "source": "session", "source_id": "669b1ae9-d975-4308-a38d-267e7ca871e4"}
{"id": "mm-06984858", "content": "The workflow engine's rule-checking system expects `check_rules` attribute on WorkflowStep objects. This is part of the lifecycle rule evaluation flow and must be present (even as empty list) on all step mocks to avoid runtime failures during workflow execution.", "type": "pattern", "importance": 0.8, "tags": ["workflow-rules", "engine-design", "required-attributes"], "created_at": "2026-02-12T17:54:08.780346+00:00", "updated_at": "2026-02-12T17:54:08.780346+00:00", "source": "session", "source_id": "0077bd03-f3d5-4da6-a660-e1329764de33"}
{"id": "mm-4a30275f", "content": "WorkflowStep mocks in tests require `check_rules = []` attribute initialization. Multiple test files (test_engine.py, test_lifecycle_observers.py, test_lifecycle_tool_rules.py, test_lifecycle_yaml_observers.py, test_observers.py) needed this added to step mocks to prevent AttributeError when engine processes rules.", "type": "fact", "importance": 0.8, "tags": ["testing", "workflow-engine", "mock-setup", "gotcha"], "created_at": "2026-02-12T17:53:48.943820+00:00", "updated_at": "2026-02-12T17:53:48.943820+00:00", "source": "session", "source_id": "0077bd03-f3d5-4da6-a660-e1329764de33"}
{"id": "mm-180dbdbd", "content": "react-force-graph-3d uses TrackballControls (not OrbitControls). TrackballControls lacks autoRotate support. To implement idle rotation, use manual camera orbit via requestAnimationFrame + fg.cameraPosition() API. Also: three-spritetext sets .scale to text dimensions (e.g. 9,3,0) during construction. Never overwrite sprite scale with absolute values — always capture original scale first and multiply by the desired factor.", "type": "pattern", "importance": 0.8, "tags": ["react-force-graph-3d", "three-spritetext", "three.js", "web-ui", "gotcha"], "created_at": "2026-02-12T17:49:51.169879+00:00", "updated_at": "2026-02-12T17:49:51.169879+00:00", "source": "mcp_tool", "source_id": "9ff21bbd-e29c-4e5a-b928-7264ca1fd6df"}
{"id": "mm-753a9f55", "content": "Config architecture goal: config.yaml should be optional. Resolution priority is: (1) database/secrets store, (2) config.yaml, (3) environment variables. Pydantic defaults cover everything else. The UI should support import/export of config. The stripped config.yaml (24 lines, non-defaults only) is the target state — everything not explicitly overridden falls through to Pydantic defaults.", "type": "fact", "importance": 0.8, "tags": ["architecture", "config", "preference"], "created_at": "2026-02-12T16:36:57.711058+00:00", "updated_at": "2026-02-12T16:36:57.711058+00:00", "source": "mcp_tool", "source_id": "655a5b27-9355-40d4-8652-60b8843105f7"}
{"id": "mm-99d5d6d2", "content": "API key resolution architecture issue: LiteLLMProvider.__init__ (litellm.py:78-80) pushes config api_keys into os.environ as a side effect. Other modules (semantic_search.py, search/embeddings.py) rely on os.environ.get('OPENAI_API_KEY') which only works because LiteLLM was initialized first. CodexProvider.get_api_key() (codex.py:121) in api_key mode reads directly from os.environ, never checking config.llm_providers.api_keys. This is fragile — depends on init order and breaks if LiteLLM isn't initialized before Codex.", "type": "fact", "importance": 0.8, "tags": ["architecture", "api-keys", "config", "bug"], "created_at": "2026-02-12T16:20:02.805974+00:00", "updated_at": "2026-02-12T16:20:02.805974+00:00", "source": "mcp_tool", "source_id": "655a5b27-9355-40d4-8652-60b8843105f7"}
{"id": "mm-87e3b260", "content": "Config supports two secret reference patterns: $secret:NAME (secrets-store-only, no env fallback) and ${VAR} (secrets store first, then env vars, then default). Use $secret:NAME when you want encrypted-at-rest secrets with no env leakage. Config.yaml uses $secret:OPENAI_API_KEY in llm_providers.api_keys. Both patterns are resolved in expand_env_vars() in config/app.py during phase 2 config loading (after DB init).", "type": "architecture", "importance": 0.8, "tags": ["config", "secrets", "api-keys"], "created_at": "2026-02-12T16:03:50.793323+00:00", "updated_at": "2026-02-12T16:03:50.793323+00:00", "source": "mcp_tool", "source_id": "8b03b181-ca3b-4b83-a28e-380a1ccfb91d"}
{"id": "mm-d0c2252c", "content": "LiteLLMProvider in llm/litellm.py sets os.environ from config api_keys. Previously had 'if value and key not in os.environ' guard which meant env vars always won over config. Changed to unconditionally set from config since config is now the source of truth (resolved from secrets store > env vars). This ensures secrets-store priority propagates to LiteLLM.", "type": "architecture", "importance": 0.8, "tags": ["litellm", "api-keys", "secrets"], "created_at": "2026-02-12T15:31:50.195663+00:00", "updated_at": "2026-02-12T15:31:50.195663+00:00", "source": "mcp_tool", "source_id": "8b03b181-ca3b-4b83-a28e-380a1ccfb91d"}
{"id": "mm-a4dc0c28", "content": "Config variable resolution has a two-phase design due to chicken-and-egg: config must load before DB init (to get db_path), but SecretStore needs the DB. Phase 1: expand_env_vars() with env vars only. Phase 2: after DB init in runner.py, reload config with secret_store.get as secret_resolver. Resolution order: secrets store > env vars > default > warn. The expand_env_vars function in config/app.py accepts an optional secret_resolver: Callable[[str], str | None] parameter.", "type": "architecture", "importance": 0.8, "tags": ["config", "secrets", "env-vars"], "created_at": "2026-02-12T15:31:19.435309+00:00", "updated_at": "2026-02-12T15:31:19.435309+00:00", "source": "mcp_tool", "source_id": "8b03b181-ca3b-4b83-a28e-380a1ccfb91d"}
{"id": "mm-bff7de2e", "content": "Unified Workflow Architecture design spec created (plan at .claude/plans/elegant-wobbling-forest.md). Key decisions: (1) Merge lifecycle + step workflows into single type — no `type` field, capabilities determined by what's declared (`triggers:` for reactive, `steps:` for state machine, both optional). (2) `enabled: true/false` flag replaces activate/deactivate dance. (3) `session_variables:` dedicated shared namespace (accessed as `session.*`) for cross-workflow state; workflow `variables:` isolated per-workflow (accessed as `variables.*`). (4) Pipeline/workflow composability: `run_pipeline` action in workflows, `spawn_session` and `activate_workflow` step types in pipelines. (5) Pipelines stay as `type: pipeline` — separate execution model bridged by composability. (6) Engine uses trigger-type index for performance, 'accumulate context, first block stops' conflict resolution.", "type": "fact", "importance": 0.8, "tags": ["architecture", "workflows", "pipelines", "design"], "created_at": "2026-02-12T07:30:44.674946+00:00", "updated_at": "2026-02-12T07:30:44.674946+00:00", "source": "mcp_tool", "source_id": "9fa21d80-09b0-4a4d-a3eb-f77ab358d231"}
{"id": "mm-e722fbed", "content": "The user decided to strip the config file to non-defaults only, which means only explicitly set configurations should remain.", "type": "preference", "importance": 0.8, "tags": ["config_cleanup", "preferences"], "created_at": "2026-02-12T05:45:13.977769+00:00", "updated_at": "2026-02-12T05:45:13.977769+00:00", "source": "session", "source_id": "687611cf-90fa-4295-ab3c-4d37d209ff2e"}
{"id": "mm-64bec743", "content": "Decision made to make `faster-whisper` a regular dependency instead of an optional one, which was documented as part of the plan update.", "type": "preference", "importance": 0.8, "tags": ["dependencies", "configuration"], "created_at": "2026-02-12T05:42:00.927185+00:00", "updated_at": "2026-02-12T05:42:00.927185+00:00", "source": "session", "source_id": "99ebf42b-ba46-43b9-8b06-426dd4af0ffd"}
{"id": "mm-869c64a9", "content": "An issue related to `create_memory` FK constraint was filed as task #8061.", "type": "context", "importance": 0.8, "tags": ["task", "create_memory", "bug"], "created_at": "2026-02-12T04:58:18.860886+00:00", "updated_at": "2026-02-12T04:58:18.860886+00:00", "source": "session", "source_id": "971fbce6-9aeb-4001-9097-8d3b11e63b18"}
{"id": "mm-4c1ef195", "content": "The file src/gobby/mcp_proxy/tools/cron.py requires adding `Literal` to the typing import.", "type": "fact", "importance": 0.8, "tags": ["imports", "typing", "cron.py"], "created_at": "2026-02-12T03:12:35.762976+00:00", "updated_at": "2026-02-12T03:12:35.762976+00:00", "source": "session", "source_id": "669b1ae9-d975-4308-a38d-267e7ca871e4"}
{"id": "mm-21e64bde", "content": "Test writing insights for gobby codebase:\n\n1. agent_definitions table has UNIQUE constraint on name - duplicate name inserts fail with IntegrityError\n2. import_from_definition() has isinstance(agent_def, AgentDefinition) check - MagicMock fails this, must use real AgentDefinition Pydantic models when testing import endpoints\n3. Foreign keys are enforced in SQLite - tests referencing project_id must create real projects first via project_manager.create()\n4. Full pytest suite with coverage takes ~43 minutes - use targeted test runs during dev\n5. Background bash commands piped through tail produce no output until process finishes - use --tb=short without pipe for long runs", "type": "fact", "importance": 0.8, "tags": ["testing", "debugging", "gotchas"], "created_at": "2026-02-12T00:01:58.128549+00:00", "updated_at": "2026-02-12T00:01:58.128549+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-bd45e000", "content": "FastAPI test patterns: 1) Lazy isinstance checks with MagicMock need autouse fixture patching the class. 2) Test dirs named after packages (mcp/) cause import conflicts. 3) Depends-based routes use dependency_overrides, not create_X_router. 4) Generic except handlers re-wrap HTTPExceptions as 500. 5) Installer backup runs before read.", "type": "fact", "importance": 0.8, "tags": ["testing", "fastapi"], "created_at": "2026-02-11T21:05:24.404982+00:00", "updated_at": "2026-02-11T21:05:24.404982+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-5e24ae05", "content": "Coding CLI auth detection locations: Codex stores auth in ~/.codex/auth.json (has tokens field for subscription, OPENAI_API_KEY field for API key) and caches its full model list in ~/.codex/models_cache.json (models array with slug, display_name, description fields). Gemini stores OAuth creds in ~/.gemini/oauth_creds.json (has refresh_token for subscription) and account info in ~/.gemini/google_accounts.json. Claude Code has no explicit auth file — subscription is implicit from binary presence. LiteLLM has litellm.models_by_provider dict and litellm.model_cost registry but NO unified list_models(api_key) function — must call provider APIs directly for dynamic model listing.", "type": "fact", "importance": 0.8, "tags": ["cli-detection", "auth", "llm", "codex", "gemini", "claude", "litellm"], "created_at": "2026-02-11T19:58:00.633183+00:00", "updated_at": "2026-02-11T19:58:00.633183+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-c6599f32", "content": "Workflow engine has two evaluators: ConditionEvaluator (eval-based, used by transitions/step rules/action when clauses) and SafeExpressionEvaluator (AST-based, used only by block_tools enforcement). Plan at docs/plans/workflow-engine-rules.md proposes unifying on the AST evaluator, adding named rule definitions with DB-backed three-tier inheritance, tool_rules shorthand, hybrid observer registry (YAML for simple, Python behaviors for complex like detect_task_claim), and simplified exit conditions.", "type": "architecture", "importance": 0.8, "tags": ["workflow-engine", "architecture", "evaluator", "rules"], "created_at": "2026-02-11T17:35:50.357886+00:00", "updated_at": "2026-02-11T17:35:50.357886+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-bc9ffa4e", "content": "Git timestamp timezone gotcha: When using git --since/--until with timestamps parsed from the database (which stores UTC with +00:00 offset), you MUST include the timezone offset in the formatted string (use %z). Without it, git interprets bare timestamps as local time, causing incorrect filtering. Also, session.jsonl_path parent (~/.claude/projects/...) is NOT a git repo — use project.repo_path from the projects table instead.", "type": "insight", "importance": 0.8, "tags": ["git", "timezone", "sessions", "gotcha"], "created_at": "2026-02-11T17:20:12.592588+00:00", "updated_at": "2026-02-11T17:20:12.592588+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-9577f734", "content": "InternalToolRegistry._get_json_schema_type() collapses union types (str|int|float|bool|None) to just the first non-None type (\"string\"). This means MCP tool params declared as union types get a string-only schema, and _coerce_args skips coercion for string-declared params. The set_variable MCP tool now has explicit coercion for string booleans/nulls/numbers in _artifacts.py to work around this.", "type": "pattern", "importance": 0.8, "tags": ["mcp", "workflow", "schema", "gotcha"], "created_at": "2026-02-11T15:29:07.579161+00:00", "updated_at": "2026-02-11T15:29:07.579161+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-830c4c3a", "content": "The gobby mcp-server stdio process (started by Claude Code) is long-running and caches Python modules from startup. When changing config validation (like MemoryConfig.validate_backend), the daemon restarts with new code but the stale mcp-server process still runs old validation. Workaround: use config values valid in BOTH old and new code, or add backwards-compat aliases in validators. Fixed by adding 'sqlite' -> 'local' alias in validate_backend. YAML bare 'null' is parsed as None - use quoted '\"null\"' for the string value.", "type": "fact", "importance": 0.8, "tags": ["debugging", "mcp-server", "config", "gotcha"], "created_at": "2026-02-10T14:25:18.003615+00:00", "updated_at": "2026-02-10T14:25:18.003615+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-749df05c", "content": "Bandit nosec annotations require space-separated codes, not comma-separated. Use `# nosec B603 B607` not `# nosec B603,B607`. Comma-separated format only suppresses the first code.", "type": "fact", "importance": 0.8, "tags": ["bandit", "python", "linting"], "created_at": "2026-02-10T04:42:58.399207+00:00", "updated_at": "2026-02-10T04:42:58.399207+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-bf5a66c2", "content": "CodeMirror + Vite duplicate module crash: The web file editor's CodeMirror component crashes with 'Unrecognized extension value in extension set... multiple instances of @codemirror/state are loaded, breaking instanceof checks.' even though npm ls shows all @codemirror/state properly deduped to one version. The fix is adding resolve.dedupe to vite.config.ts: resolve: { dedupe: ['@codemirror/state', '@codemirror/view', '@codemirror/language'] }. This is a well-known Vite dev server issue where dependency pre-bundling creates separate module copies.", "type": "debugging", "importance": 0.8, "tags": ["web-ui", "codemirror", "vite", "debugging"], "created_at": "2026-02-10T02:47:10.252217+00:00", "updated_at": "2026-02-10T02:47:10.252217+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-eed85876", "content": "Migration 77 has a UNIQUE constraint issue on seq_num that requires clearing values to NULL before reassigning to avoid violations. This is a known gotcha when modifying sequence numbers in migrations.", "type": "context", "importance": 0.8, "tags": ["migration", "database", "constraints", "gobby"], "created_at": "2026-01-27T01:29:58.428788+00:00", "updated_at": "2026-01-27T01:29:58.428788+00:00", "source": "session", "source_id": "2bc8895b-b292-4b81-acfc-180c276ca5cd"}
{"id": "mm-04676fa3", "content": "The _LazyBool class in task_enforcement_actions.py lacks __eq__ and __ne__ operators, causing expressions like 'session_has_dirty_files == False' to skip thunk evaluation. Add __eq__(self, other) and __ne__(self, other) methods that coerce self to bool via bool(self) before comparison to ensure lazy evaluation is triggered and comparisons return correct True/False semantics.", "type": "pattern", "importance": 0.8, "tags": ["lazy-evaluation", "task-enforcement", "operator-overloading", "python-semantics"], "created_at": "2026-01-25T16:54:00.257505+00:00", "updated_at": "2026-01-25T16:54:00.257505+00:00", "source": "session", "source_id": "389037ea-8953-4e4f-bcb4-29c5dc468357"}
{"id": "mm-0dc68d2a", "content": "The _normalize_timestamp() function in sync/tasks.py should treat empty string as None (return None if ts == ''), and use regex pattern matching (e.g., r'Z|[+-]\\d{2}:\\d{2}$') to detect RFC3339 timezone suffixes instead of brittle slice checks. Only append 'Z' when the pattern does not match the timestamp suffix.", "type": "pattern", "importance": 0.8, "tags": ["timestamp-handling", "iso8601", "sync", "task-export", "regex-validation"], "created_at": "2026-01-25T04:38:01.653774+00:00", "updated_at": "2026-01-25T04:38:01.653774+00:00", "source": "session", "source_id": "389037ea-8953-4e4f-bcb4-29c5dc468357"}
{"id": "mm-41a61c2a", "content": "Memory ID generation in gobby uses '||' delimiter between content and project_id to prevent collisions (e.g., 'abc'+'def' vs 'abcd'+'ef'). This is implemented in src/gobby/storage/memories.py.", "type": "fact", "importance": 0.8, "tags": ["gobby", "memory-system", "id-generation", "collision-prevention"], "created_at": "2026-01-25T04:17:24.123650+00:00", "updated_at": "2026-01-25T04:17:24.123650+00:00", "source": "session", "source_id": "c9787d92-bd8e-4fcc-a158-05af9147f470"}
{"id": "mm-28d8d578", "content": "Test fixtures in gobby: protect_production_resources fixture patches load_config in already-imported modules (e.g., gobby.runner, gobby.mcp_proxy.stdio) to use safe_load_config with test DB paths. Must be added to test signature to ensure safe DB is used when instantiating GobbyRunner.", "type": "fact", "importance": 0.8, "tags": ["testing", "fixtures", "safety"], "created_at": "2026-01-25T04:04:50.334561+00:00", "updated_at": "2026-01-25T04:04:50.334561+00:00", "source": "session", "source_id": "90eefa0c-bedd-4489-bcd4-df7bf8a3cc6b"}
{"id": "mm-3f91e1c8", "content": "The _is_plan_file() function in task_enforcement_actions.py should explicitly check `if source != \"claude\"` rather than `if source and source != \"claude\"` to enforce that a source value must be present and not 'claude'. This prevents plan files from being processed without explicit source attribution.", "type": "pattern", "importance": 0.8, "tags": ["validation", "task-enforcement", "source-attribution"], "created_at": "2026-01-25T04:02:56.263283+00:00", "updated_at": "2026-01-25T04:02:56.263283+00:00", "source": "session", "source_id": "1a867b59-ad3d-4075-9020-6293616fbeb2"}
{"id": "mm-a028f56e", "content": "Gobby has migrated to database schema v75 as baseline minimum. Legacy migrations (versions 0-75) are from migrations_legacy.py, while new migrations v76+ go in MIGRATIONS list. run_migrations rejects versions below v75, and docstrings should reference v75+ not v60+.", "type": "fact", "importance": 0.78, "tags": ["database", "migrations", "schema-version"], "created_at": "2026-01-28T03:41:22.372041+00:00", "updated_at": "2026-01-28T03:41:22.372041+00:00", "source": "session", "source_id": "740c4be1-cfcc-4aa0-ab30-7a088d85d22d"}
{"id": "mm-d62a4423", "content": "User decision: For config tools architecture, chose 'New gobby-config server' approach over ad-hoc additions to existing patterns. This architectural direction was documented in jazzy-stargazing-map.md plan file.", "type": "preference", "importance": 0.75, "tags": ["config", "architecture-decision", "gobby-config"], "created_at": "2026-02-13T01:22:43.063444+00:00", "updated_at": "2026-02-13T01:22:43.063444+00:00", "source": "session", "source_id": "a5e24b58-a6c5-4da0-b65b-b05ff10f1c38"}
{"id": "mm-fa438a26", "content": "Gobby has a find_free_port() function that needs investigation/fixing - identified during session analysis as part of a 4-task improvement plan (fix find_free_port, verify port binding logic, update config handling, add integration tests).", "type": "context", "importance": 0.75, "tags": ["gobby", "port-management", "bug", "planned-work"], "created_at": "2026-02-12T20:14:46.878501+00:00", "updated_at": "2026-02-12T20:14:46.878501+00:00", "source": "session", "source_id": "aed5d772-3baa-4249-b0f2-cd721b653301"}
{"id": "mm-7bbe1f5e", "content": "Skill YAML parsing correctly handles `alwaysApply: true` field and converts it to the `always_apply` boolean property in ParsedSkill. The parsing logic in allowed_tools handling (around line 270) properly routes this through the skill injector.", "type": "pattern", "importance": 0.75, "tags": ["yaml-parsing", "skill-config"], "created_at": "2026-02-12T19:25:42.948218+00:00", "updated_at": "2026-02-12T19:25:42.948218+00:00", "source": "session", "source_id": "60cfb08d-8b7d-4c3b-8d91-b24dae2cbabd"}
{"id": "mm-2e8d0b10", "content": "Workflow activation on a session is persistent and requires explicit deactivation/ending via hook_dispatcher.py before the session can cleanly stop - accidental workflow activation can block session exit.", "type": "pattern", "importance": 0.75, "tags": ["workflow-lifecycle", "session-management", "debugging"], "created_at": "2026-01-28T20:38:12.091482+00:00", "updated_at": "2026-01-28T20:38:12.091482+00:00", "source": "session", "source_id": "8cc46e99-2e03-41f8-ba7e-7ad372450e56"}
{"id": "mm-f3c42990", "content": "When debugging gobby agent spawns, check: (1) session transcripts via gobby-sessions tools—empty transcript means agent never ran, (2) agent run records via agent runs queries, (3) gobby.log for 'Invalid JSON at line 0' warnings in transcript parsing. Silent failures can occur where spawn claims success but no Ghostty launches and no agent registers.", "type": "pattern", "importance": 0.75, "tags": ["gobby", "debugging", "troubleshooting", "spawn_agent", "validation"], "created_at": "2026-01-28T20:27:23.836631+00:00", "updated_at": "2026-01-28T20:27:23.836631+00:00", "source": "session", "source_id": "d347d68e-869d-4a6e-a8d5-8fe855bba25e"}
{"id": "mm-f4d2816d", "content": "Memory exports in gobby should sanitize user home paths by replacing absolute paths with '~' using _sanitize_content() method (src/gobby/sync/memories.py) to avoid exposing user-specific paths.", "type": "pattern", "importance": 0.75, "tags": ["gobby", "memory-export", "path-sanitization", "privacy"], "created_at": "2026-01-25T04:17:24.127397+00:00", "updated_at": "2026-01-25T04:17:24.127397+00:00", "source": "session", "source_id": "c9787d92-bd8e-4fcc-a158-05af9147f470"}
{"id": "mm-47d4c0a8", "content": "E2E test env leak: protect_production_resources sets GOBBY_TEST_PROTECT=1 in the test process env. When e2e conftest spawns daemon subprocesses via os.environ.copy(), this flag leaks into the subprocess. The daemon's load_config safety switch then fires but GOBBY_DATABASE_PATH was already popped, causing inconsistent state. Fix: pop GOBBY_TEST_PROTECT and GOBBY_CONFIG_FILE from daemon subprocess env alongside GOBBY_DATABASE_PATH.", "type": "debugging", "importance": 0.7, "tags": ["e2e-tests", "env-vars", "conftest", "root-cause"], "created_at": "2026-02-13T00:38:23.915080+00:00", "updated_at": "2026-02-13T00:38:23.915080+00:00", "source": "mcp_tool", "source_id": "3459526d-63d7-414f-9a94-66cf359ad6a9"}
{"id": "mm-ee1a9610", "content": "SO_REUSEADDR port collision root cause: When find_free_port() uses SO_REUSEADDR, the OS can assign a port (e.g. 60887) to localhost even if production daemon is bound on 0.0.0.0:60887 — they're treated as non-conflicting addresses. The verification bind also passes with SO_REUSEADDR. Fix: remove SO_REUSEADDR from both sockets and add a 0.0.0.0 verification bind. Also exclude known gobby ports (60887/60888) as defense-in-depth. File: tests/e2e/conftest.py:find_free_port().", "type": "fact", "importance": 0.7, "tags": ["debugging", "e2e-tests", "port-isolation", "networking"], "created_at": "2026-02-12T20:20:49.727285+00:00", "updated_at": "2026-02-12T20:20:49.727285+00:00", "source": "mcp_tool", "source_id": "432c9580-9d9f-46ca-9c22-ad02bfc2d171"}
{"id": "mm-10f41d2a", "content": "Auto-Task Workflow: Activate with session_task variable (not assigned_task_id): activate_workflow(name='auto-task', variables={session_task: '#1234'}). Meeseeks agent pattern is deprecated and no longer in use. The call_tool MCP proxy uses `arguments` parameter (not `args`).", "type": "pattern", "importance": 0.7, "tags": ["workflows", "auto-task", "mcp"], "created_at": "2026-02-12T19:39:41.876752+00:00", "updated_at": "2026-02-12T19:39:41.876752+00:00", "source": "mcp_tool", "source_id": "4552a4b4-25cd-4850-b649-29cff6320a00"}
{"id": "mm-9948faed", "content": "Terminal Spawning (macOS): The Ghostty spawner on macOS injects env vars via shell exports because macOS `open` command doesn't pass env vars to launched apps. In macos.py GhosttySpawner.spawn(), if env vars are provided, they're converted to shell exports and prepended to the command: `exports = \" \".join(f\"export {k}={v};\" for k, v in env.items())` then `shell_cmd = f\"{exports} exec {shlex.join(command)}\"` with `ghostty_args.extend([\"-e\", \"sh\", \"-c\", shell_cmd])`.", "type": "pattern", "importance": 0.7, "tags": ["terminal", "macos", "ghostty", "spawner"], "created_at": "2026-02-12T19:34:14.417744+00:00", "updated_at": "2026-02-12T19:34:14.417744+00:00", "source": "mcp_tool", "source_id": "4552a4b4-25cd-4850-b649-29cff6320a00"}
{"id": "mm-f2923cfe", "content": "SafeExpressionEvaluator.evaluate() in src/gobby/workflows/safe_evaluator.py wraps results in bool() at line 81: `return bool(self.visit(tree.body))`. While visit_BoolOp returns actual Python values (empty string, dict, etc.), the public evaluate() API always returns a bool. Assertions using `is True`/`is False` are correct for evaluate() output. Don't change them to value comparisons like `== ''` or `== 'abc'`.", "type": "fact", "importance": 0.7, "tags": ["safe-evaluator", "gotcha", "testing"], "created_at": "2026-02-12T18:41:42.956800+00:00", "updated_at": "2026-02-12T18:41:42.956800+00:00", "source": "mcp_tool", "source_id": "66cb7110-c987-47a1-8e86-08cb1109e0f0"}
{"id": "mm-b6c982c8", "content": "Gobby UI config: ui.enabled must be true and bind_host must be 0.0.0.0 (not localhost) for the web UI to be accessible over Tailscale/network. The UI is served by the main HTTP server (not a separate Vite process) in production mode from web/dist/. The daemon can take 15-30s to start listening on the port after the process starts — health checks may time out during this window but the daemon eventually comes up.", "type": "fact", "importance": 0.7, "tags": ["config", "ui", "tailscale", "networking"], "created_at": "2026-02-12T15:04:59.021038+00:00", "updated_at": "2026-02-12T15:04:59.021038+00:00", "source": "mcp_tool", "source_id": "16810f19-280c-4a8e-9663-ac826ae47c0c"}
{"id": "mm-50bbaf1e", "content": "ConditionEvaluator.check_exit_conditions() context has 'task_list': state.task_list as an internal key. Variables with the same name as WorkflowState fields (task_list, step_action_count, total_action_count) are skipped during merge to avoid shadowing. Use variables.get('task_list') in exit_when expressions when the variable name collides with a WorkflowState field. The variable_set condition type checks state.variables directly and doesn't have this issue.", "type": "insight", "importance": 0.7, "tags": ["workflows", "evaluator", "exit_conditions", "gotcha"], "created_at": "2026-02-12T05:59:35.138443+00:00", "updated_at": "2026-02-12T05:59:35.138443+00:00", "source": "mcp_tool", "source_id": "8264345e-68a1-4f70-bbea-e4d703df9389"}
{"id": "mm-2b8a7c06", "content": "When using unittest.mock.patch() with string paths like 'gobby.cli.installers.claude.install_claude', the patch fails if gobby.cli hasn't been imported yet (module 'gobby' has no attribute 'cli'). Fix: use patch.object() with direct module imports instead (e.g., from gobby.cli.installers import claude as claude_mod; patch.object(claude_mod, 'install_claude')). This is a general Python gotcha with lazy/nested imports and mock.patch string paths.", "type": "fact", "importance": 0.7, "tags": ["testing", "mocking", "python", "gotcha"], "created_at": "2026-02-12T05:11:14.402419+00:00", "updated_at": "2026-02-12T05:11:14.402419+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-d370bb38", "content": "FastAPI test patterns learned during coverage push:\n\n1. isinstance with lazy imports: When route handlers do `from gobby.storage.database import LocalDatabase; isinstance(db, LocalDatabase)`, MagicMock fails. Fix: autouse fixture patching `gobby.storage.database.LocalDatabase` with `MagicMock` class so isinstance(MagicMock(), MagicMock) returns True.\n\n2. Test directory naming conflicts: Never name a test directory after a Python package (e.g., tests/servers/routes/mcp/ clashes with the `mcp` package). Use `mcp_endpoints/` instead.\n\n3. FastAPI dependency_overrides: Routes using Depends(get_server) need `app.dependency_overrides[get_server] = override_fn` instead of `create_X_router(mock_server)` pattern.\n\n4. Exception re-wrapping: If a route catches HTTPException(503) inside a generic `except Exception`, it re-raises as 500. Check the actual handler logic when writing test assertions.\n\n5. Installer backup-before-read order: copy2 (backup) runs before open (read), so making a file unreadable causes 'Failed to create backup' not 'Failed to read'.", "type": "fact", "importance": 0.7, "tags": ["testing", "fastapi", "patterns", "mocking"], "created_at": "2026-02-11T21:04:37.108848+00:00", "updated_at": "2026-02-11T21:04:37.108848+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-f1f0f287", "content": "FastAPI routes that return Union types like dict[str, Any] | JSONResponse will fail with FastAPIError at app startup. Fix: add response_model=None to the route decorator. Example: @router.post('/path', response_model=None). Found in cron.py run_job_now route.", "type": "fact", "importance": 0.7, "tags": ["fastapi", "gotcha", "routes"], "created_at": "2026-02-11T19:58:42.089630+00:00", "updated_at": "2026-02-11T19:58:42.089630+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-0b35820d", "content": "Project resolution mock targets: When testing CLI commands that resolve project IDs, patch gobby.cli.utils.get_project_context (not gobby.cli.tasks.crud.get_project_context), because resolve_project_ref() in cli/utils.py does the actual import. The _resolve_project_id in hook_manager.py now falls back to PERSONAL_PROJECT_ID instead of calling initialize_project.", "type": "pattern", "importance": 0.7, "tags": ["testing", "mocking", "project-resolution"], "created_at": "2026-02-10T20:21:43.208477+00:00", "updated_at": "2026-02-10T20:21:43.208477+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-822e34ff", "content": "Playwright tests for the gobby web UI: The Files page (useFiles.ts hook) now uses relative URLs through the Vite proxy (getBaseUrl returns ''). Use page.route('**/api/files/*') to intercept and mock API calls in tests. Navigation requires opening the sidebar first via .hamburger-button click, then clicking the .sidebar-item. The terminal-colors.spec.ts test is broken because it skips this step. Run Playwright tests from web/ directory: cd web && npx playwright test.", "type": "pattern", "importance": 0.7, "tags": ["web-ui", "playwright", "testing"], "created_at": "2026-02-10T02:47:17.713217+00:00", "updated_at": "2026-02-10T02:58:26.595438+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-2095597f", "content": "After changing ~/.gobby/config.yaml (e.g., switching memory backend), the gobby daemon must be restarted with 'uv run gobby restart' to pick up the new configuration. Config changes are not hot-reloaded.", "type": "fact", "importance": 0.7, "tags": "daemon,config,restart", "created_at": "2026-02-10T02:42:48.459768+00:00", "updated_at": "2026-02-10T02:42:48.459768+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-b3f85f4e", "content": "Bandit config consistency: pyproject.toml [tool.bandit] skips are only applied when -c pyproject.toml is passed. The pre-commit hook and CI both pass it correctly, but the local pre-push-test.sh scripts did not — causing false failures. Always check all invocation sites when adding bandit skips.", "type": "insight", "importance": 0.6, "tags": ["bandit", "ci", "pre-push", "config"], "created_at": "2026-02-13T01:09:45.729082+00:00", "updated_at": "2026-02-13T01:09:45.729082+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-64cd33cb", "content": "test_runner.py isinstance check gotcha: isinstance(mock_instance, MockedClass) fails with 'TypeError: isinstance() arg 2 must be a type' because patch() replaces the class with a MagicMock (not a real type). When runner.py added isinstance(self.database, LocalDatabase), all test_runner tests broke. Fix: removed the isinstance check (redundant since _init_database always returns LocalDatabase) and added SecretStore/ConfigStore patches to create_base_patches.", "type": "debugging", "importance": 0.6, "tags": ["testing", "mocking", "isinstance", "runner"], "created_at": "2026-02-13T00:38:47.336129+00:00", "updated_at": "2026-02-13T00:38:47.336129+00:00", "source": "mcp_tool", "source_id": "3459526d-63d7-414f-9a94-66cf359ad6a9"}
{"id": "mm-b411f6ab", "content": "Gobby UI dev server auto-start: GobbyRunner.run() now spawns Vite via spawn_ui_server when ui.enabled=true and ui.mode=dev, and stops it on shutdown. Port lineup: 60887 (HTTP daemon), 60888 (WebSocket), 60889 (Vite dev). Config default is UIConfig.port=60889. The spawn/stop helpers live in gobby.cli.utils (spawn_ui_server, stop_ui_server, find_web_dir).", "type": "fact", "importance": 0.6, "tags": ["web-ui", "architecture", "ports"], "created_at": "2026-02-12T21:08:14.538094+00:00", "updated_at": "2026-02-12T21:08:14.538094+00:00", "source": "mcp_tool", "source_id": "432c9580-9d9f-46ca-9c22-ad02bfc2d171"}
{"id": "mm-5e9fc5fa", "content": "SafeExpressionEvaluator.evaluate() in src/gobby/workflows/lifecycle_evaluator.py explicitly wraps results in bool() (line ~81: return bool(self.visit(tree.body))). Test assertions should use `is True`/`is False`, not `== \"\"`/`== \"abc\"`. CodeRabbit incorrectly flagged these assertions — they are correct as-is.", "type": "pattern", "importance": 0.6, "tags": ["workflows", "evaluator", "testing"], "created_at": "2026-02-12T19:39:17.121415+00:00", "updated_at": "2026-02-12T19:39:17.121415+00:00", "source": "mcp_tool", "source_id": "4552a4b4-25cd-4850-b649-29cff6320a00"}
{"id": "mm-0441424c", "content": "Feature removal gotcha: When removing a field from a dataclass (e.g., WorkflowState.artifacts), MagicMock(spec=WorkflowState) in tests will correctly reject the removed attribute — but production code that still references it will cause AttributeError at runtime. This means removing a model field requires checking not just tests but all production code paths that use the model. The state_manager SQL (INSERT/UPDATE) must also be updated if a DB column is removed from the baseline schema, or new databases will fail.", "type": "insight", "importance": 0.6, "tags": ["testing", "refactoring", "gotcha", "sqlite"], "created_at": "2026-02-12T04:56:48.553094+00:00", "updated_at": "2026-02-12T04:56:48.553094+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-a4dd55df", "content": "GobbyTask (list interface) and GobbyTaskDetail (detail interface) are separate TypeScript interfaces in useTasks.ts. GobbyTask is the lighter version used in task lists — it does NOT include project_id, description, labels, etc. Only GobbyTaskDetail extends GobbyTask with those fields. When filtering tasks by project_id client-side, project_id must be added to the base GobbyTask interface.", "type": "pattern", "importance": 0.6, "tags": ["frontend", "typescript", "tasks", "gotcha"], "created_at": "2026-02-11T17:33:42.755231+00:00", "updated_at": "2026-02-11T17:33:42.755231+00:00", "source": "mcp_tool", "source_id": null}
{"id": "mm-46d0f151", "content": "memu-py SDK was removed from gobby due to critical upstream bug: create_memory_item() missing resource_id parameter. Replaced with sqlite backend.", "type": "fact", "importance": 0.6, "tags": "memory,memu,removal", "created_at": "2026-02-10T02:41:44.504868+00:00", "updated_at": "2026-02-10T02:41:44.504868+00:00", "source": "mcp_tool", "source_id": null}
