daemon_port: 8765
daemon_health_check_interval: 60.0
websocket:
  enabled: true
  port: 8766
  ping_interval: 30
  ping_timeout: 10
logging:
  level: debug
  format: text
  client: ~/.gobby/logs/gobby.log
  client_error: ~/.gobby/logs/gobby-error.log
  hook_manager: ~/.gobby/logs/hook-manager.log
  mcp_server: ~/.gobby/logs/mcp-server.log
  mcp_client: ~/.gobby/logs/mcp-client.log
  max_size_mb: 10
  backup_count: 5
mcp_client_proxy:
  enabled: true
  connect_timeout: 30.0
  proxy_timeout: 30
  tool_timeout: 30
  tool_timeouts:
    expand_task: 300.0
gobby-tasks:
  enabled: true
  show_result_on_create: false
  expansion:
    enabled: true
    # Behavior settings (tdd_mode, auto_decompose, etc.) are in workflow YAML variables.
    # See: .gobby/workflows/lifecycle/session-lifecycle.yaml
    provider: claude
    model: claude-opus-4-5
    codebase_research_enabled: true
    research_max_steps: 10
    research_system_prompt: "You are a senior developer researching a codebase. Use tools to find relevant code."
    web_research_enabled: true
    max_subtasks: 10
    default_strategy: auto # auto, phased, sequential, or parallel
    timeout: 300.0 # Max time for entire expansion (5 minutes)
    research_timeout: 60.0 # Max time for research phase (1 minute)
  validation:
    enabled: true
    provider: claude
    model: claude-haiku-4-5
    system_prompt: "You are a QA validator. Output ONLY valid JSON. No markdown, no explanation, no code blocks. Just the raw JSON object."
    criteria_system_prompt: "You are a QA engineer writing acceptance criteria. CRITICAL: Only include requirements explicitly stated in the task. Do NOT invent specific values, thresholds, timeouts, or edge cases that are not mentioned. Vague tasks get vague criteria. Use markdown checkboxes."
    # Custom prompt for generating validation criteria. Available placeholders: {title}, {description}
    # criteria_prompt: |
    #   Generate acceptance criteria for:
    #   Task: {title}
    #   Description: {description}
    #
    #   Return a bulleted list of testable conditions.
    # Validation loop control
    max_iterations: 10 # Max validation attempts before escalation
    max_consecutive_errors: 3 # Max consecutive errors before stopping
    recurring_issue_threshold: 3 # Same issue count before escalation
    issue_similarity_threshold: 0.8 # Similarity threshold for recurring issues (0-1)
    # Build verification
    run_build_first: true # Run build/test before LLM validation
    # build_command: null  # Custom build command (auto-detect if not set)
    # External validator
    use_external_validator: false # Use different LLM for validation
    # external_validator_model: null  # Model for external validation
    # Escalation settings
    escalation_enabled: true # Enable task escalation on failures
    escalation_notify: none # Notification method: webhook, slack, or none
    # escalation_webhook_url: null  # Webhook URL for escalation notifications
llm_providers:
  claude:
    models: claude-haiku-4-5,claude-sonnet-4-5,claude-opus-4-5
    auth_mode: subscription
  codex:
    models: gpt-4o-mini,gpt-5-mini,gpt-5,gpt-5-high
    auth_mode: subscription
  gemini:
    models: gemini-3
    auth_mode: subscription
  litellm:
    models: gpt-4o-mini,gpt-5-mini
    auth_mode: api_key
  # API keys - set via environment variables or uncomment and fill in below
  # api_keys:
  #   OPENAI_API_KEY: "<YOUR_OPENAI_API_KEY>"
  #   MISTRAL_API_KEY: "<YOUR_MISTRAL_API_KEY>"
hook_extensions:
  websocket:
    enabled: true
    broadcast_events:
      - session-start
      - session-end
      - pre-tool-use
      - post-tool-use
    include_payload: true
  plugins:
    enabled: false # Set to true to enable plugins (runs with daemon privileges)
    plugin_dirs:
      - ~/.gobby/plugins
      - .gobby/plugins
    auto_discover: true
    plugins:
      code-guardian:
        enabled: true # Will load when plugins.enabled is true
        config:
          checks: [ruff]
          block_on_error: false # Start permissive, user can enable blocking
          auto_fix: true
workflow:
  enabled: true
  timeout: 30.0
import_mcp_server:
  enabled: true
  provider: claude
  model: claude-haiku-4-5
  github_fetch_prompt: |
    Fetch the README from this GitHub repository and extract MCP server configuration:

    {github_url}

    If the URL doesn't point directly to a README, try to find and fetch the README.md file.

    After reading the documentation, extract the MCP server configuration as a JSON object.
  search_fetch_prompt: |
    Search for MCP server: {search_query}

    Find the official documentation or GitHub repository for this MCP server.
    Then fetch and read the README or installation docs.

    After reading the documentation, extract the MCP server configuration as a JSON object.
message_tracking:
  enabled: true
  poll_interval: 5.0
  debounce_delay: 1.0
  max_message_length: 10000
  broadcast_enabled: true
session_lifecycle:
  active_session_pause_minutes: 30
  stale_session_timeout_hours: 24
  expire_check_interval_minutes: 60
  transcript_processing_interval_minutes: 5
  transcript_processing_batch_size: 10
compact_handoff:
  enabled: true

session_summary:
  enabled: false
  provider: claude
  model: claude-haiku-4-5
  summary_file_path: ~/.gobby/session_summaries/
  prompt: 'Analyze this session transcript and create a comprehensive
    session summary.

    ## Transcript (last 50 turns):

    {transcript_summary}


    ## Last Messages:

    {last_messages}


    ## Git Status:

    {git_status}


    ## Files Changed:

    {file_changes}


    Create a markdown summary with the following sections (do NOT include a top-level
    ''# Session Summary'' header):


    ## Overview

    [1-2 paragraph summary of what was accomplished in this session]


    ## Key Decisions

    [List of important technical or architectural decisions made, with bullet points]


    ## Important Lessons Learned

    [Technical insights, gotchas, or patterns discovered, with bullet points]


    ## Substantive Interrupts

    [Times when the user changed direction significantly - NOT simple "continue" or
    "resume" prompts]


    ## Research & Epiphanies

    [Key discoveries from research or debugging that should be remembered, with bullet
    points]


    ### Interactions (X substantive of Y total)

    [This section will be automatically populated with substantive interactions from
    the session]


    ## Files Changed

    {file_changes}

    [Add specific details about WHY each file was changed and WHAT the changes accomplish.]


    ## Git Status

    ```

    {git_status}

    ```


    ## Claude Specific Todo List (or equivalent if provided by another LLM)

    [This section will be automatically populated with the actual TodoWrite list if
    it exists]


    ## Next Steps

    [Concrete, numbered suggestions for what to do when resuming work. Be specific
    and actionable.]


    Focus on actionable insights and context that would be valuable when resuming
    work later.

    Use only ASCII-safe characters - avoid Unicode em-dashes, smart quotes, or special
    characters.'
title_synthesis:
  enabled: true
  provider: claude
  model: claude-haiku-4-5
  prompt: "Generate a concise 3-6 word title summarizing the user's intent.

    Use title case. Be specific and descriptive. Focus on the task/goal.

    Respond with ONLY the title, no explanation or quotes.


    User's first message:

    {user_prompt}"
code_execution:
  enabled: true
  provider: claude
  model: claude-sonnet-4-5
  max_turns: 5
  default_timeout: 30
  max_dataset_preview: 3
  prompt: "Execute the following code and return the result.

    Context: {context}

    Code:

    ```
    {language}

    {code}
    ```

    Return the execution output or any errors encountered."
recommend_tools:
  enabled: true
  provider: claude
  model: claude-sonnet-4-5
  prompt:
    'You are a tool recommendation assistant for Claude Code with access to
    MCP servers.


    CRITICAL PRIORITIZATION RULES:

    1. Analyze the task type (code navigation, docs lookup, database query, planning,
    data processing, etc.)

    2. Check available MCP server DESCRIPTIONS for capability matches

    3. If ANY MCP server''s description matches the task type -> recommend those tools
    FIRST

    4. Only recommend built-in Claude Code tools (Grep, Read, Bash, WebSearch) if
    NO suitable MCP server exists


    TASK TYPE MATCHING GUIDELINES:

    - Task needs library/framework documentation -> Look for MCP servers describing
    "documentation", "library docs", "API reference"

    - Task needs code navigation/architecture understanding -> Look for MCP servers
    describing "code analysis", "symbols", "semantic search"

    - Task needs database operations -> Look for MCP servers describing "database",
    "PostgreSQL", "SQL"

    - Task needs complex reasoning/planning -> Look for MCP servers describing "problem-solving",
    "thinking", "reasoning"

    - Task needs data processing/large datasets -> Look for MCP servers describing
    "code execution", "data processing", "token optimization"


    ANTI-PATTERNS (What NOT to recommend):

    - Don''t recommend WebSearch when an MCP server provides library/framework documentation

    - Don''t recommend Grep/Read for code architecture questions when an MCP server
    does semantic code analysis

    - Don''t recommend Bash for database queries when an MCP server provides database
    tools

    - Don''t recommend direct implementation when an MCP server provides structured
    reasoning


    OUTPUT FORMAT:

    Be concise and specific. Recommend 1-3 tools maximum with:

    1. Which MCP server and tools to use (if applicable)

    2. Brief rationale based on server description matching task type

    3. Suggested workflow (e.g., "First call X, then use result with Y")

    4. Only mention built-in tools if no MCP server is suitable.'
  hybrid_rerank_prompt: |
    You are an expert at selecting tools for tasks.
    Task: {task_description}

    Candidate tools (ranked by semantic similarity):
    {candidate_list}

    Re-rank these tools by relevance to the task and provide reasoning.
    Return the top {top_k} most relevant as JSON:
    {{
      "recommendations": [
        {{
          "server": "server_name",
          "tool": "tool_name",
          "reason": "Why this tool is the best choice"
        }}
      ]
    }}
  llm_prompt: |
    You are an expert at selecting the right tools for a given task.
    Task: {task_description}

    Available Servers: {available_servers}

    Please recommend which tools from these servers would be most useful for this task.
    Return a JSON object with this structure:
    {{
      "recommendations": [
        {{
          "server": "server_name",
          "tool": "tool_name",
          "reason": "Why this tool is useful"
        }}
      ]
    }}
tool_summarizer:
  enabled: true
  provider: claude
  model: claude-haiku-4-5
  prompt: |
    Summarize this MCP tool description in 180 characters or less.
    Keep it to three sentences or less. Be concise and preserve the key functionality.
    Do not add quotes, extra formatting, or code examples.

    Description: {description}

    Summary:
  system_prompt: "You are a technical summarizer. Create concise tool descriptions."
  server_description_prompt: |
    Write a single concise sentence describing what the '{server_name}' MCP server does based on its tools.

    Tools:
    {tools_list}

    Description (1 sentence, try to keep under 100 characters):
  server_description_system_prompt: "You write concise technical descriptions."
